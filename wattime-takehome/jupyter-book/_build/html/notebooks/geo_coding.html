
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Merging TRACE and FAOSTAT Data with Geographic Data for Mapping &#8212; Measuring Global Rice Paddy CH4 Emissions</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/android-chrome-512x512.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Emissions Estimation Data: A Comparison between FAOSTAT and University of Malysia Estimates" href="data_exploration.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Measuring Global Rice Paddy CH4 Emissions</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Blog Posts
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="hidden_post.html">
   Are We Undercounting Global Methane Emissions? (No Code Example)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="full_post.html">
   Are We Undercounting Global Methane Emissions? (Code Example)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Analysis of The University of Malaysia Paper
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="replicating_paper.html">
   Replicating the University of Malysia Paper.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="testing_malaysian_paper.html">
   Hypothesis Testing the University of Malaysia Paper
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Exploration
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="data_exploration.html">
   Emissions Estimation Data: A Comparison between FAOSTAT and University of Malysia Estimates
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Merging TRACE and FAOSTAT Data with Geographic Data for Mapping
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/geo_coding.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/justin-napolitano/ch4-emissions"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/justin-napolitano/ch4-emissions/issues/new?title=Issue%20on%20page%20%2Fnotebooks/geo_coding.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/justin-napolitano/ch4-emissions/master?urlpath=tree/docs/notebooks/geo_coding.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#shape-data">
   Shape Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#faostat-data">
   FAOSTAT DATA
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#faostat-country-merge">
     FAOSTAT Country Merge
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#faostat-merge-to-file">
     FAOSTAT Merge to File
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trace-data">
   TRACE Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trace-country-merge">
     TRACE Country Merge
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trace-merge-to-file">
     Trace Merge to File
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-geo-data">
   Merge GEO DATA
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#merged-countries-to-file">
     Merged Countries to File
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Merging TRACE and FAOSTAT Data with Geographic Data for Mapping</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#shape-data">
   Shape Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#faostat-data">
   FAOSTAT DATA
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#faostat-country-merge">
     FAOSTAT Country Merge
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#faostat-merge-to-file">
     FAOSTAT Merge to File
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trace-data">
   TRACE Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trace-country-merge">
     TRACE Country Merge
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trace-merge-to-file">
     Trace Merge to File
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merge-geo-data">
   Merge GEO DATA
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#merged-countries-to-file">
     Merged Countries to File
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="merging-trace-and-faostat-data-with-geographic-data-for-mapping">
<h1>Merging TRACE and FAOSTAT Data with Geographic Data for Mapping<a class="headerlink" href="#merging-trace-and-faostat-data-with-geographic-data-for-mapping" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">folium</span>
<span class="kn">import</span> <span class="nn">contextily</span> <span class="k">as</span> <span class="nn">cx</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">LineString</span><span class="p">,</span> <span class="n">Polygon</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">cKDTree</span>
<span class="kn">from</span> <span class="nn">geopy.distance</span> <span class="kn">import</span> <span class="n">distance</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/jnapolitano/venvs/finance/lib/python3.9/site-packages/geopandas/_compat.py:111: UserWarning: The Shapely GEOS version (3.10.2-CAPI-1.16.0) is incompatible with the GEOS version PyGEOS was compiled with (3.10.1-CAPI-1.16.0). Conversions between both will be slow.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="section" id="shape-data">
<h2>Shape Data<a class="headerlink" href="#shape-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gisfilepath</span> <span class="o">=</span> <span class="s2">&quot;/Users/jnapolitano/Projects/wattime-takehome/data/country_shapefiles/World_Countries__Generalized_.shp&quot;</span>


<span class="n">countries_df</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">gisfilepath</span><span class="p">)</span>

<span class="n">countries_df</span> <span class="o">=</span> <span class="n">countries_df</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">3857</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">))</span>

<span class="n">cities</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">gpd</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_cities&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;iso_a3&quot;</span> <span class="p">:</span>  <span class="s1">&#39;iso3_country&#39;</span><span class="p">},</span><span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">world</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop_est</th>
      <th>continent</th>
      <th>name</th>
      <th>iso3_country</th>
      <th>gdp_md_est</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>920938</td>
      <td>Oceania</td>
      <td>Fiji</td>
      <td>FJI</td>
      <td>8374.0</td>
      <td>MULTIPOLYGON (((180.00000 -16.06713, 180.00000...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>53950935</td>
      <td>Africa</td>
      <td>Tanzania</td>
      <td>TZA</td>
      <td>150600.0</td>
      <td>POLYGON ((33.90371 -0.95000, 34.07262 -1.05982...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>603253</td>
      <td>Africa</td>
      <td>W. Sahara</td>
      <td>ESH</td>
      <td>906.5</td>
      <td>POLYGON ((-8.66559 27.65643, -8.66512 27.58948...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35623680</td>
      <td>North America</td>
      <td>Canada</td>
      <td>CAN</td>
      <td>1674000.0</td>
      <td>MULTIPOLYGON (((-122.84000 49.00000, -122.9742...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>326625791</td>
      <td>North America</td>
      <td>United States of America</td>
      <td>USA</td>
      <td>18560000.0</td>
      <td>MULTIPOLYGON (((-122.84000 49.00000, -120.0000...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>172</th>
      <td>7111024</td>
      <td>Europe</td>
      <td>Serbia</td>
      <td>SRB</td>
      <td>101800.0</td>
      <td>POLYGON ((18.82982 45.90887, 18.82984 45.90888...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>642550</td>
      <td>Europe</td>
      <td>Montenegro</td>
      <td>MNE</td>
      <td>10610.0</td>
      <td>POLYGON ((20.07070 42.58863, 19.80161 42.50009...</td>
    </tr>
    <tr>
      <th>174</th>
      <td>1895250</td>
      <td>Europe</td>
      <td>Kosovo</td>
      <td>-99</td>
      <td>18490.0</td>
      <td>POLYGON ((20.59025 41.85541, 20.52295 42.21787...</td>
    </tr>
    <tr>
      <th>175</th>
      <td>1218208</td>
      <td>North America</td>
      <td>Trinidad and Tobago</td>
      <td>TTO</td>
      <td>43570.0</td>
      <td>POLYGON ((-61.68000 10.76000, -61.10500 10.890...</td>
    </tr>
    <tr>
      <th>176</th>
      <td>13026129</td>
      <td>Africa</td>
      <td>S. Sudan</td>
      <td>SSD</td>
      <td>20880.0</td>
      <td>POLYGON ((30.83385 3.50917, 29.95350 4.17370, ...</td>
    </tr>
  </tbody>
</table>
<p>177 rows × 6 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="faostat-data">
<h2>FAOSTAT DATA<a class="headerlink" href="#faostat-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;/Users/jnapolitano/Projects/wattime-takehome/data/FAOSTAT_DATA.csv&quot;</span>

<span class="n">faostat_emissions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">faostat_emissions_df</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="p">[(</span><span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s2">&quot;country_name&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Total&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s2">&quot;country_name&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;mean&quot;</span><span class="p">)]</span>
<span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faostat_emissions_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso3_country</th>
      <th>country_name</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>tCO2_2015</th>
      <th>tCO2_2016</th>
      <th>tCO2_2017</th>
      <th>tCO2_2018</th>
      <th>tCO2_2019</th>
      <th>Mean_CH4</th>
      <th>Total_CH4</th>
      <th>Mean_CO2</th>
      <th>Total_CO2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BGD</td>
      <td>Bangladesh</td>
      <td>1131293.4</td>
      <td>1093480.4</td>
      <td>1154531.0</td>
      <td>1144591.0</td>
      <td>1144745.4</td>
      <td>28282335.0</td>
      <td>27337010.0</td>
      <td>28863275.0</td>
      <td>28614775.0</td>
      <td>28618635.0</td>
      <td>1133728.24</td>
      <td>5668641.2</td>
      <td>28343206.0</td>
      <td>141716030.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BRA</td>
      <td>Brazil</td>
      <td>138910.3</td>
      <td>126278.2</td>
      <td>130322.9</td>
      <td>121615.2</td>
      <td>111084.8</td>
      <td>3472757.5</td>
      <td>3156955.0</td>
      <td>3258072.5</td>
      <td>3040380.0</td>
      <td>2777120.0</td>
      <td>125642.28</td>
      <td>628211.4</td>
      <td>3141057.0</td>
      <td>15705285.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHN</td>
      <td>China</td>
      <td>5406593.9</td>
      <td>5399920.0</td>
      <td>5400129.0</td>
      <td>5302173.1</td>
      <td>5214454.7</td>
      <td>135164847.5</td>
      <td>134998000.0</td>
      <td>135003225.0</td>
      <td>132554327.5</td>
      <td>130361367.5</td>
      <td>5344654.14</td>
      <td>26723270.7</td>
      <td>133616353.5</td>
      <td>668081767.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ESP</td>
      <td>Spain</td>
      <td>55082.2</td>
      <td>55073.1</td>
      <td>54232.4</td>
      <td>52925.0</td>
      <td>52098.5</td>
      <td>1377055.0</td>
      <td>1376827.5</td>
      <td>1355810.0</td>
      <td>1323125.0</td>
      <td>1302462.5</td>
      <td>53882.24</td>
      <td>269411.2</td>
      <td>1347056.0</td>
      <td>6735280.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IDN</td>
      <td>Indonesia</td>
      <td>2407953.5</td>
      <td>2387656.4</td>
      <td>2425290.6</td>
      <td>2405613.8</td>
      <td>2257604.3</td>
      <td>60198837.5</td>
      <td>59691410.0</td>
      <td>60632265.0</td>
      <td>60140345.0</td>
      <td>56440107.5</td>
      <td>2376823.72</td>
      <td>11884118.6</td>
      <td>59420593.0</td>
      <td>297102965.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>IND</td>
      <td>India</td>
      <td>4580248.4</td>
      <td>4559136.4</td>
      <td>4620790.8</td>
      <td>4661154.9</td>
      <td>4621416.8</td>
      <td>114506210.0</td>
      <td>113978410.0</td>
      <td>115519770.0</td>
      <td>116528872.5</td>
      <td>115535420.0</td>
      <td>4608549.46</td>
      <td>23042747.3</td>
      <td>115213736.5</td>
      <td>576068682.5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>IRN</td>
      <td>Iran (Islamic Republic of)</td>
      <td>116486.7</td>
      <td>131008.5</td>
      <td>87233.6</td>
      <td>93936.6</td>
      <td>96103.4</td>
      <td>2912167.5</td>
      <td>3275212.5</td>
      <td>2180840.0</td>
      <td>2348415.0</td>
      <td>2402585.0</td>
      <td>104953.76</td>
      <td>524768.8</td>
      <td>2623844.0</td>
      <td>13119220.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ITA</td>
      <td>Italy</td>
      <td>114574.8</td>
      <td>118003.0</td>
      <td>118003.0</td>
      <td>109463.8</td>
      <td>110895.1</td>
      <td>2864370.0</td>
      <td>2950075.0</td>
      <td>2950075.0</td>
      <td>2736595.0</td>
      <td>2772377.5</td>
      <td>114187.94</td>
      <td>570939.7</td>
      <td>2854698.5</td>
      <td>14273492.5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>330353.1</td>
      <td>326403.0</td>
      <td>323700.3</td>
      <td>322245.0</td>
      <td>320581.8</td>
      <td>8258827.5</td>
      <td>8160075.0</td>
      <td>8092507.5</td>
      <td>8056125.0</td>
      <td>8014545.0</td>
      <td>324656.64</td>
      <td>1623283.2</td>
      <td>8116416.0</td>
      <td>40582080.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>KHM</td>
      <td>Cambodia</td>
      <td>436826.0</td>
      <td>459003.1</td>
      <td>473745.3</td>
      <td>479362.7</td>
      <td>468378.9</td>
      <td>10920650.0</td>
      <td>11475077.5</td>
      <td>11843632.5</td>
      <td>11984067.5</td>
      <td>11709472.5</td>
      <td>463463.20</td>
      <td>2317316.0</td>
      <td>11586580.0</td>
      <td>57932900.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>KOR</td>
      <td>Korea (the Republic of)</td>
      <td>167862.2</td>
      <td>163534.1</td>
      <td>158489.7</td>
      <td>154911.3</td>
      <td>153260.9</td>
      <td>4196555.0</td>
      <td>4088352.5</td>
      <td>3962242.5</td>
      <td>3872782.5</td>
      <td>3831522.5</td>
      <td>159611.64</td>
      <td>798058.2</td>
      <td>3990291.0</td>
      <td>19951455.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>LAO</td>
      <td>Lao People's Democratic Republic (the)</td>
      <td>94826.8</td>
      <td>95630.0</td>
      <td>93940.7</td>
      <td>83333.6</td>
      <td>77005.5</td>
      <td>2370670.0</td>
      <td>2390750.0</td>
      <td>2348517.5</td>
      <td>2083340.0</td>
      <td>1925137.5</td>
      <td>88947.32</td>
      <td>444736.6</td>
      <td>2223683.0</td>
      <td>11118415.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>LKA</td>
      <td>Sri Lanka</td>
      <td>132640.0</td>
      <td>121756.3</td>
      <td>84456.3</td>
      <td>111049.0</td>
      <td>102156.3</td>
      <td>3316000.0</td>
      <td>3043907.5</td>
      <td>2111407.5</td>
      <td>2776225.0</td>
      <td>2553907.5</td>
      <td>110411.58</td>
      <td>552057.9</td>
      <td>2760289.5</td>
      <td>13801447.5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>MMR</td>
      <td>Myanmar</td>
      <td>1059409.6</td>
      <td>1052287.7</td>
      <td>1087029.5</td>
      <td>1118850.0</td>
      <td>1083100.3</td>
      <td>26485240.0</td>
      <td>26307192.5</td>
      <td>27175737.5</td>
      <td>27971250.0</td>
      <td>27077507.5</td>
      <td>1080135.42</td>
      <td>5400677.1</td>
      <td>27003385.5</td>
      <td>135016927.5</td>
    </tr>
    <tr>
      <th>14</th>
      <td>MYS</td>
      <td>Malaysia</td>
      <td>121942.6</td>
      <td>123232.8</td>
      <td>122656.3</td>
      <td>125238.5</td>
      <td>122453.8</td>
      <td>3048565.0</td>
      <td>3080820.0</td>
      <td>3066407.5</td>
      <td>3130962.5</td>
      <td>3061345.0</td>
      <td>123104.80</td>
      <td>615524.0</td>
      <td>3077620.0</td>
      <td>15388100.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NPL</td>
      <td>Nepal</td>
      <td>149262.2</td>
      <td>142723.7</td>
      <td>162574.6</td>
      <td>153890.8</td>
      <td>156215.4</td>
      <td>3731555.0</td>
      <td>3568092.5</td>
      <td>4064365.0</td>
      <td>3847270.0</td>
      <td>3905385.0</td>
      <td>152933.34</td>
      <td>764666.7</td>
      <td>3823333.5</td>
      <td>19116667.5</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PAK</td>
      <td>Pakistan</td>
      <td>383529.3</td>
      <td>381361.8</td>
      <td>406083.3</td>
      <td>393404.2</td>
      <td>424755.1</td>
      <td>9588232.5</td>
      <td>9534045.0</td>
      <td>10152082.5</td>
      <td>9835105.0</td>
      <td>10618877.5</td>
      <td>397826.74</td>
      <td>1989133.7</td>
      <td>9945668.5</td>
      <td>49728342.5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>PHL</td>
      <td>Philippines (the)</td>
      <td>1557810.6</td>
      <td>1524292.5</td>
      <td>1609862.5</td>
      <td>1606047.8</td>
      <td>1556225.8</td>
      <td>38945265.0</td>
      <td>38107312.5</td>
      <td>40246562.5</td>
      <td>40151195.0</td>
      <td>38905645.0</td>
      <td>1570847.84</td>
      <td>7854239.2</td>
      <td>39271196.0</td>
      <td>196355980.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>PRK</td>
      <td>Korea (the Democratic People's Republic of)</td>
      <td>82823.3</td>
      <td>83442.3</td>
      <td>84596.2</td>
      <td>83943.3</td>
      <td>82937.0</td>
      <td>2070582.5</td>
      <td>2086057.5</td>
      <td>2114905.0</td>
      <td>2098582.5</td>
      <td>2073425.0</td>
      <td>83548.42</td>
      <td>417742.1</td>
      <td>2088710.5</td>
      <td>10443552.5</td>
    </tr>
    <tr>
      <th>19</th>
      <td>THA</td>
      <td>Thailand</td>
      <td>1554254.0</td>
      <td>1703327.7</td>
      <td>1714465.6</td>
      <td>1702989.1</td>
      <td>1553835.5</td>
      <td>38856350.0</td>
      <td>42583192.5</td>
      <td>42861640.0</td>
      <td>42574727.5</td>
      <td>38845887.5</td>
      <td>1645774.38</td>
      <td>8228871.9</td>
      <td>41144359.5</td>
      <td>205721797.5</td>
    </tr>
    <tr>
      <th>20</th>
      <td>TWN</td>
      <td>Taiwan (Province of China)</td>
      <td>45838.7</td>
      <td>49838.3</td>
      <td>49991.2</td>
      <td>49414.1</td>
      <td>49152.0</td>
      <td>1145967.5</td>
      <td>1245957.5</td>
      <td>1249780.0</td>
      <td>1235352.5</td>
      <td>1228800.0</td>
      <td>48846.86</td>
      <td>244234.3</td>
      <td>1221171.5</td>
      <td>6105857.5</td>
    </tr>
    <tr>
      <th>21</th>
      <td>USA</td>
      <td>United States of America (the)</td>
      <td>364728.0</td>
      <td>438662.0</td>
      <td>336255.5</td>
      <td>412177.5</td>
      <td>350136.5</td>
      <td>9118200.0</td>
      <td>10966550.0</td>
      <td>8406387.5</td>
      <td>10304437.5</td>
      <td>8753412.5</td>
      <td>380391.90</td>
      <td>1901959.5</td>
      <td>9509797.5</td>
      <td>47548987.5</td>
    </tr>
    <tr>
      <th>22</th>
      <td>VNM</td>
      <td>Viet Nam</td>
      <td>1381744.4</td>
      <td>1365173.8</td>
      <td>1360551.6</td>
      <td>1336231.2</td>
      <td>1318431.1</td>
      <td>34543610.0</td>
      <td>34129345.0</td>
      <td>34013790.0</td>
      <td>33405780.0</td>
      <td>32960777.5</td>
      <td>1352426.42</td>
      <td>6762132.1</td>
      <td>33810660.5</td>
      <td>169053302.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="faostat-country-merge">
<h3>FAOSTAT Country Merge<a class="headerlink" href="#faostat-country-merge" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faostat_merged_df</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">faostat_emissions_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;iso3_country&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faostat_merged_df</span>
<span class="c1">#trace_merged_df.dropna(axis=1, how=&#39;any&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop_est</th>
      <th>continent</th>
      <th>name</th>
      <th>iso3_country</th>
      <th>gdp_md_est</th>
      <th>geometry</th>
      <th>country_name</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>...</th>
      <th>2019</th>
      <th>tCO2_2015</th>
      <th>tCO2_2016</th>
      <th>tCO2_2017</th>
      <th>tCO2_2018</th>
      <th>tCO2_2019</th>
      <th>Mean_CH4</th>
      <th>Total_CH4</th>
      <th>Mean_CO2</th>
      <th>Total_CO2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>157826578</td>
      <td>Asia</td>
      <td>Bangladesh</td>
      <td>BGD</td>
      <td>628400.0</td>
      <td>POLYGON ((92.67272 22.04124, 92.65226 21.32405...</td>
      <td>Bangladesh</td>
      <td>1131293.4</td>
      <td>1093480.4</td>
      <td>1154531.0</td>
      <td>...</td>
      <td>1144745.4</td>
      <td>28282335.0</td>
      <td>27337010.0</td>
      <td>28863275.0</td>
      <td>28614775.0</td>
      <td>28618635.0</td>
      <td>1133728.24</td>
      <td>5668641.2</td>
      <td>28343206.0</td>
      <td>141716030.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>207353391</td>
      <td>South America</td>
      <td>Brazil</td>
      <td>BRA</td>
      <td>3081000.0</td>
      <td>POLYGON ((-53.37366 -33.76838, -53.65054 -33.2...</td>
      <td>Brazil</td>
      <td>138910.3</td>
      <td>126278.2</td>
      <td>130322.9</td>
      <td>...</td>
      <td>111084.8</td>
      <td>3472757.5</td>
      <td>3156955.0</td>
      <td>3258072.5</td>
      <td>3040380.0</td>
      <td>2777120.0</td>
      <td>125642.28</td>
      <td>628211.4</td>
      <td>3141057.0</td>
      <td>15705285.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1379302771</td>
      <td>Asia</td>
      <td>China</td>
      <td>CHN</td>
      <td>21140000.0</td>
      <td>MULTIPOLYGON (((109.47521 18.19770, 108.65521 ...</td>
      <td>China</td>
      <td>5406593.9</td>
      <td>5399920.0</td>
      <td>5400129.0</td>
      <td>...</td>
      <td>5214454.7</td>
      <td>135164847.5</td>
      <td>134998000.0</td>
      <td>135003225.0</td>
      <td>132554327.5</td>
      <td>130361367.5</td>
      <td>5344654.14</td>
      <td>26723270.7</td>
      <td>133616353.5</td>
      <td>668081767.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48958159</td>
      <td>Europe</td>
      <td>Spain</td>
      <td>ESP</td>
      <td>1690000.0</td>
      <td>POLYGON ((-7.45373 37.09779, -7.53711 37.42890...</td>
      <td>Spain</td>
      <td>55082.2</td>
      <td>55073.1</td>
      <td>54232.4</td>
      <td>...</td>
      <td>52098.5</td>
      <td>1377055.0</td>
      <td>1376827.5</td>
      <td>1355810.0</td>
      <td>1323125.0</td>
      <td>1302462.5</td>
      <td>53882.24</td>
      <td>269411.2</td>
      <td>1347056.0</td>
      <td>6735280.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>260580739</td>
      <td>Asia</td>
      <td>Indonesia</td>
      <td>IDN</td>
      <td>3028000.0</td>
      <td>MULTIPOLYGON (((141.00021 -2.60015, 141.01706 ...</td>
      <td>Indonesia</td>
      <td>2407953.5</td>
      <td>2387656.4</td>
      <td>2425290.6</td>
      <td>...</td>
      <td>2257604.3</td>
      <td>60198837.5</td>
      <td>59691410.0</td>
      <td>60632265.0</td>
      <td>60140345.0</td>
      <td>56440107.5</td>
      <td>2376823.72</td>
      <td>11884118.6</td>
      <td>59420593.0</td>
      <td>297102965.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1281935911</td>
      <td>Asia</td>
      <td>India</td>
      <td>IND</td>
      <td>8721000.0</td>
      <td>POLYGON ((97.32711 28.26158, 97.40256 27.88254...</td>
      <td>India</td>
      <td>4580248.4</td>
      <td>4559136.4</td>
      <td>4620790.8</td>
      <td>...</td>
      <td>4621416.8</td>
      <td>114506210.0</td>
      <td>113978410.0</td>
      <td>115519770.0</td>
      <td>116528872.5</td>
      <td>115535420.0</td>
      <td>4608549.46</td>
      <td>23042747.3</td>
      <td>115213736.5</td>
      <td>576068682.5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>82021564</td>
      <td>Asia</td>
      <td>Iran</td>
      <td>IRN</td>
      <td>1459000.0</td>
      <td>POLYGON ((48.56797 29.92678, 48.01457 30.45246...</td>
      <td>Iran (Islamic Republic of)</td>
      <td>116486.7</td>
      <td>131008.5</td>
      <td>87233.6</td>
      <td>...</td>
      <td>96103.4</td>
      <td>2912167.5</td>
      <td>3275212.5</td>
      <td>2180840.0</td>
      <td>2348415.0</td>
      <td>2402585.0</td>
      <td>104953.76</td>
      <td>524768.8</td>
      <td>2623844.0</td>
      <td>13119220.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>62137802</td>
      <td>Europe</td>
      <td>Italy</td>
      <td>ITA</td>
      <td>2221000.0</td>
      <td>MULTIPOLYGON (((10.44270 46.89355, 11.04856 46...</td>
      <td>Italy</td>
      <td>114574.8</td>
      <td>118003.0</td>
      <td>118003.0</td>
      <td>...</td>
      <td>110895.1</td>
      <td>2864370.0</td>
      <td>2950075.0</td>
      <td>2950075.0</td>
      <td>2736595.0</td>
      <td>2772377.5</td>
      <td>114187.94</td>
      <td>570939.7</td>
      <td>2854698.5</td>
      <td>14273492.5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>126451398</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>JPN</td>
      <td>4932000.0</td>
      <td>MULTIPOLYGON (((141.88460 39.18086, 140.95949 ...</td>
      <td>Japan</td>
      <td>330353.1</td>
      <td>326403.0</td>
      <td>323700.3</td>
      <td>...</td>
      <td>320581.8</td>
      <td>8258827.5</td>
      <td>8160075.0</td>
      <td>8092507.5</td>
      <td>8056125.0</td>
      <td>8014545.0</td>
      <td>324656.64</td>
      <td>1623283.2</td>
      <td>8116416.0</td>
      <td>40582080.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>16204486</td>
      <td>Asia</td>
      <td>Cambodia</td>
      <td>KHM</td>
      <td>58940.0</td>
      <td>POLYGON ((102.58493 12.18659, 102.34810 13.394...</td>
      <td>Cambodia</td>
      <td>436826.0</td>
      <td>459003.1</td>
      <td>473745.3</td>
      <td>...</td>
      <td>468378.9</td>
      <td>10920650.0</td>
      <td>11475077.5</td>
      <td>11843632.5</td>
      <td>11984067.5</td>
      <td>11709472.5</td>
      <td>463463.20</td>
      <td>2317316.0</td>
      <td>11586580.0</td>
      <td>57932900.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>51181299</td>
      <td>Asia</td>
      <td>South Korea</td>
      <td>KOR</td>
      <td>1929000.0</td>
      <td>POLYGON ((126.17476 37.74969, 126.23734 37.840...</td>
      <td>Korea (the Republic of)</td>
      <td>167862.2</td>
      <td>163534.1</td>
      <td>158489.7</td>
      <td>...</td>
      <td>153260.9</td>
      <td>4196555.0</td>
      <td>4088352.5</td>
      <td>3962242.5</td>
      <td>3872782.5</td>
      <td>3831522.5</td>
      <td>159611.64</td>
      <td>798058.2</td>
      <td>3990291.0</td>
      <td>19951455.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>7126706</td>
      <td>Asia</td>
      <td>Laos</td>
      <td>LAO</td>
      <td>40960.0</td>
      <td>POLYGON ((107.38273 14.20244, 106.49637 14.570...</td>
      <td>Lao People's Democratic Republic (the)</td>
      <td>94826.8</td>
      <td>95630.0</td>
      <td>93940.7</td>
      <td>...</td>
      <td>77005.5</td>
      <td>2370670.0</td>
      <td>2390750.0</td>
      <td>2348517.5</td>
      <td>2083340.0</td>
      <td>1925137.5</td>
      <td>88947.32</td>
      <td>444736.6</td>
      <td>2223683.0</td>
      <td>11118415.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>22409381</td>
      <td>Asia</td>
      <td>Sri Lanka</td>
      <td>LKA</td>
      <td>236700.0</td>
      <td>POLYGON ((81.78796 7.52306, 81.63732 6.48178, ...</td>
      <td>Sri Lanka</td>
      <td>132640.0</td>
      <td>121756.3</td>
      <td>84456.3</td>
      <td>...</td>
      <td>102156.3</td>
      <td>3316000.0</td>
      <td>3043907.5</td>
      <td>2111407.5</td>
      <td>2776225.0</td>
      <td>2553907.5</td>
      <td>110411.58</td>
      <td>552057.9</td>
      <td>2760289.5</td>
      <td>13801447.5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>55123814</td>
      <td>Asia</td>
      <td>Myanmar</td>
      <td>MMR</td>
      <td>311100.0</td>
      <td>POLYGON ((100.11599 20.41785, 99.54331 20.1866...</td>
      <td>Myanmar</td>
      <td>1059409.6</td>
      <td>1052287.7</td>
      <td>1087029.5</td>
      <td>...</td>
      <td>1083100.3</td>
      <td>26485240.0</td>
      <td>26307192.5</td>
      <td>27175737.5</td>
      <td>27971250.0</td>
      <td>27077507.5</td>
      <td>1080135.42</td>
      <td>5400677.1</td>
      <td>27003385.5</td>
      <td>135016927.5</td>
    </tr>
    <tr>
      <th>14</th>
      <td>31381992</td>
      <td>Asia</td>
      <td>Malaysia</td>
      <td>MYS</td>
      <td>863000.0</td>
      <td>MULTIPOLYGON (((100.08576 6.46449, 100.25960 6...</td>
      <td>Malaysia</td>
      <td>121942.6</td>
      <td>123232.8</td>
      <td>122656.3</td>
      <td>...</td>
      <td>122453.8</td>
      <td>3048565.0</td>
      <td>3080820.0</td>
      <td>3066407.5</td>
      <td>3130962.5</td>
      <td>3061345.0</td>
      <td>123104.80</td>
      <td>615524.0</td>
      <td>3077620.0</td>
      <td>15388100.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>29384297</td>
      <td>Asia</td>
      <td>Nepal</td>
      <td>NPL</td>
      <td>71520.0</td>
      <td>POLYGON ((88.12044 27.87654, 88.04313 27.44582...</td>
      <td>Nepal</td>
      <td>149262.2</td>
      <td>142723.7</td>
      <td>162574.6</td>
      <td>...</td>
      <td>156215.4</td>
      <td>3731555.0</td>
      <td>3568092.5</td>
      <td>4064365.0</td>
      <td>3847270.0</td>
      <td>3905385.0</td>
      <td>152933.34</td>
      <td>764666.7</td>
      <td>3823333.5</td>
      <td>19116667.5</td>
    </tr>
    <tr>
      <th>16</th>
      <td>204924861</td>
      <td>Asia</td>
      <td>Pakistan</td>
      <td>PAK</td>
      <td>988200.0</td>
      <td>POLYGON ((77.83745 35.49401, 76.87172 34.65354...</td>
      <td>Pakistan</td>
      <td>383529.3</td>
      <td>381361.8</td>
      <td>406083.3</td>
      <td>...</td>
      <td>424755.1</td>
      <td>9588232.5</td>
      <td>9534045.0</td>
      <td>10152082.5</td>
      <td>9835105.0</td>
      <td>10618877.5</td>
      <td>397826.74</td>
      <td>1989133.7</td>
      <td>9945668.5</td>
      <td>49728342.5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>104256076</td>
      <td>Asia</td>
      <td>Philippines</td>
      <td>PHL</td>
      <td>801900.0</td>
      <td>MULTIPOLYGON (((120.83390 12.70450, 120.32344 ...</td>
      <td>Philippines (the)</td>
      <td>1557810.6</td>
      <td>1524292.5</td>
      <td>1609862.5</td>
      <td>...</td>
      <td>1556225.8</td>
      <td>38945265.0</td>
      <td>38107312.5</td>
      <td>40246562.5</td>
      <td>40151195.0</td>
      <td>38905645.0</td>
      <td>1570847.84</td>
      <td>7854239.2</td>
      <td>39271196.0</td>
      <td>196355980.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>25248140</td>
      <td>Asia</td>
      <td>North Korea</td>
      <td>PRK</td>
      <td>40000.0</td>
      <td>MULTIPOLYGON (((130.78000 42.22001, 130.78000 ...</td>
      <td>Korea (the Democratic People's Republic of)</td>
      <td>82823.3</td>
      <td>83442.3</td>
      <td>84596.2</td>
      <td>...</td>
      <td>82937.0</td>
      <td>2070582.5</td>
      <td>2086057.5</td>
      <td>2114905.0</td>
      <td>2098582.5</td>
      <td>2073425.0</td>
      <td>83548.42</td>
      <td>417742.1</td>
      <td>2088710.5</td>
      <td>10443552.5</td>
    </tr>
    <tr>
      <th>19</th>
      <td>68414135</td>
      <td>Asia</td>
      <td>Thailand</td>
      <td>THA</td>
      <td>1161000.0</td>
      <td>POLYGON ((105.21878 14.27321, 104.28142 14.416...</td>
      <td>Thailand</td>
      <td>1554254.0</td>
      <td>1703327.7</td>
      <td>1714465.6</td>
      <td>...</td>
      <td>1553835.5</td>
      <td>38856350.0</td>
      <td>42583192.5</td>
      <td>42861640.0</td>
      <td>42574727.5</td>
      <td>38845887.5</td>
      <td>1645774.38</td>
      <td>8228871.9</td>
      <td>41144359.5</td>
      <td>205721797.5</td>
    </tr>
    <tr>
      <th>20</th>
      <td>23508428</td>
      <td>Asia</td>
      <td>Taiwan</td>
      <td>TWN</td>
      <td>1127000.0</td>
      <td>POLYGON ((121.77782 24.39427, 121.17563 22.790...</td>
      <td>Taiwan (Province of China)</td>
      <td>45838.7</td>
      <td>49838.3</td>
      <td>49991.2</td>
      <td>...</td>
      <td>49152.0</td>
      <td>1145967.5</td>
      <td>1245957.5</td>
      <td>1249780.0</td>
      <td>1235352.5</td>
      <td>1228800.0</td>
      <td>48846.86</td>
      <td>244234.3</td>
      <td>1221171.5</td>
      <td>6105857.5</td>
    </tr>
    <tr>
      <th>21</th>
      <td>326625791</td>
      <td>North America</td>
      <td>United States of America</td>
      <td>USA</td>
      <td>18560000.0</td>
      <td>MULTIPOLYGON (((-122.84000 49.00000, -120.0000...</td>
      <td>United States of America (the)</td>
      <td>364728.0</td>
      <td>438662.0</td>
      <td>336255.5</td>
      <td>...</td>
      <td>350136.5</td>
      <td>9118200.0</td>
      <td>10966550.0</td>
      <td>8406387.5</td>
      <td>10304437.5</td>
      <td>8753412.5</td>
      <td>380391.90</td>
      <td>1901959.5</td>
      <td>9509797.5</td>
      <td>47548987.5</td>
    </tr>
    <tr>
      <th>22</th>
      <td>96160163</td>
      <td>Asia</td>
      <td>Vietnam</td>
      <td>VNM</td>
      <td>594900.0</td>
      <td>POLYGON ((104.33433 10.48654, 105.19991 10.889...</td>
      <td>Viet Nam</td>
      <td>1381744.4</td>
      <td>1365173.8</td>
      <td>1360551.6</td>
      <td>...</td>
      <td>1318431.1</td>
      <td>34543610.0</td>
      <td>34129345.0</td>
      <td>34013790.0</td>
      <td>33405780.0</td>
      <td>32960777.5</td>
      <td>1352426.42</td>
      <td>6762132.1</td>
      <td>33810660.5</td>
      <td>169053302.5</td>
    </tr>
  </tbody>
</table>
<p>23 rows × 21 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faostat_merged_df</span> <span class="o">=</span> <span class="n">faostat_merged_df</span><span class="p">[</span><span class="n">faostat_merged_df</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Antarctica&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="faostat-merge-to-file">
<h3>FAOSTAT Merge to File<a class="headerlink" href="#faostat-merge-to-file" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gisout</span> <span class="o">=</span> <span class="s2">&quot;/Users/jnapolitano/Projects/wattime-takehome/data/FAOSTAT_GEO.geojson&quot;</span>
<span class="n">faostat_merged_df</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">gisout</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/jnapolitano/venvs/finance/lib/python3.9/site-packages/geopandas/io/file.py:362: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  pd.Int64Index,
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="trace-data">
<h2>TRACE Data<a class="headerlink" href="#trace-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;/Users/jnapolitano/Projects/wattime-takehome/data/TRACE_DATA.csv&quot;</span>

<span class="n">trace_emissions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
<span class="n">trace_emissions_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">trace_emissions_df</span> <span class="o">=</span> <span class="n">trace_emissions_df</span><span class="p">[(</span><span class="n">trace_emissions_df</span><span class="p">[</span><span class="s2">&quot;country_name&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Total&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">trace_emissions_df</span><span class="p">[</span><span class="s2">&quot;country_name&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;mean&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace_emissions_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iso3_country</th>
      <th>country_name</th>
      <th>tCH4_2015</th>
      <th>tCH4_2016</th>
      <th>tCH4_2017</th>
      <th>tCH4_2018</th>
      <th>tCH4_2019</th>
      <th>tCH4_2020</th>
      <th>tCH4_2021</th>
      <th>tCO2_2015</th>
      <th>tCO2_2016</th>
      <th>tCO2_2017</th>
      <th>tCO2_2018</th>
      <th>tCO2_2019</th>
      <th>Mean_CH4</th>
      <th>Total_CH4</th>
      <th>Mean_CO2</th>
      <th>Total_CO2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BGD</td>
      <td>Bangladesh</td>
      <td>2.344420e+06</td>
      <td>2.278158e+06</td>
      <td>2.098958e+06</td>
      <td>2.141231e+06</td>
      <td>2.070985e+06</td>
      <td>2.106781e+06</td>
      <td>1.983974e+06</td>
      <td>5.861049e+07</td>
      <td>5.695395e+07</td>
      <td>5.247394e+07</td>
      <td>5.353076e+07</td>
      <td>5.177463e+07</td>
      <td>2.186750e+06</td>
      <td>1.093375e+07</td>
      <td>5.466875e+07</td>
      <td>2.733438e+08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BRA</td>
      <td>Brazil</td>
      <td>3.410233e+05</td>
      <td>3.104189e+05</td>
      <td>3.725173e+05</td>
      <td>3.717030e+05</td>
      <td>3.294713e+05</td>
      <td>4.902874e+05</td>
      <td>4.544874e+05</td>
      <td>8.525583e+06</td>
      <td>7.760473e+06</td>
      <td>9.312934e+06</td>
      <td>9.292575e+06</td>
      <td>8.236783e+06</td>
      <td>3.450268e+05</td>
      <td>1.725134e+06</td>
      <td>8.625670e+06</td>
      <td>4.312835e+07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHN</td>
      <td>China</td>
      <td>6.133647e+06</td>
      <td>5.859531e+06</td>
      <td>6.355071e+06</td>
      <td>5.413962e+06</td>
      <td>5.603352e+06</td>
      <td>6.402353e+06</td>
      <td>6.068210e+06</td>
      <td>1.533412e+08</td>
      <td>1.464883e+08</td>
      <td>1.588768e+08</td>
      <td>1.353491e+08</td>
      <td>1.400838e+08</td>
      <td>5.873113e+06</td>
      <td>2.936556e+07</td>
      <td>1.468278e+08</td>
      <td>7.341391e+08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ESP</td>
      <td>Spain</td>
      <td>1.141464e+04</td>
      <td>1.334803e+04</td>
      <td>1.217299e+04</td>
      <td>1.405410e+04</td>
      <td>1.148324e+04</td>
      <td>1.305461e+04</td>
      <td>8.531579e+03</td>
      <td>2.853661e+05</td>
      <td>3.337007e+05</td>
      <td>3.043248e+05</td>
      <td>3.513524e+05</td>
      <td>2.870810e+05</td>
      <td>1.249460e+04</td>
      <td>6.247300e+04</td>
      <td>3.123650e+05</td>
      <td>1.561825e+06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IDN</td>
      <td>Indonesia</td>
      <td>1.283649e+06</td>
      <td>1.023129e+06</td>
      <td>9.615327e+05</td>
      <td>1.176982e+06</td>
      <td>1.266668e+06</td>
      <td>1.188195e+06</td>
      <td>1.009936e+06</td>
      <td>3.209122e+07</td>
      <td>2.557824e+07</td>
      <td>2.403832e+07</td>
      <td>2.942454e+07</td>
      <td>3.166670e+07</td>
      <td>1.142392e+06</td>
      <td>5.711960e+06</td>
      <td>2.855980e+07</td>
      <td>1.427990e+08</td>
    </tr>
    <tr>
      <th>5</th>
      <td>IND</td>
      <td>India</td>
      <td>6.219887e+06</td>
      <td>5.309413e+06</td>
      <td>6.228451e+06</td>
      <td>6.589798e+06</td>
      <td>7.501556e+06</td>
      <td>7.599764e+06</td>
      <td>6.567960e+06</td>
      <td>1.554972e+08</td>
      <td>1.327353e+08</td>
      <td>1.557113e+08</td>
      <td>1.647450e+08</td>
      <td>1.875389e+08</td>
      <td>6.369821e+06</td>
      <td>3.184910e+07</td>
      <td>1.592455e+08</td>
      <td>7.962276e+08</td>
    </tr>
    <tr>
      <th>6</th>
      <td>IRN</td>
      <td>Iran (Islamic Republic of)</td>
      <td>8.774407e+04</td>
      <td>9.180121e+04</td>
      <td>9.620217e+04</td>
      <td>8.875744e+04</td>
      <td>9.500199e+04</td>
      <td>9.600254e+04</td>
      <td>9.053525e+04</td>
      <td>2.193602e+06</td>
      <td>2.295030e+06</td>
      <td>2.405054e+06</td>
      <td>2.218936e+06</td>
      <td>2.375050e+06</td>
      <td>9.190138e+04</td>
      <td>4.595069e+05</td>
      <td>2.297534e+06</td>
      <td>1.148767e+07</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ITA</td>
      <td>Italy</td>
      <td>4.995968e+04</td>
      <td>4.937785e+04</td>
      <td>5.443679e+04</td>
      <td>4.469902e+04</td>
      <td>4.566914e+04</td>
      <td>5.101547e+04</td>
      <td>5.089759e+04</td>
      <td>1.248992e+06</td>
      <td>1.234446e+06</td>
      <td>1.360920e+06</td>
      <td>1.117475e+06</td>
      <td>1.141729e+06</td>
      <td>4.882850e+04</td>
      <td>2.441425e+05</td>
      <td>1.220712e+06</td>
      <td>6.103562e+06</td>
    </tr>
    <tr>
      <th>8</th>
      <td>JPN</td>
      <td>Japan</td>
      <td>2.305465e+05</td>
      <td>2.284133e+05</td>
      <td>2.708935e+05</td>
      <td>1.548252e+05</td>
      <td>2.332056e+05</td>
      <td>2.835167e+05</td>
      <td>1.574007e+05</td>
      <td>5.763662e+06</td>
      <td>5.710333e+06</td>
      <td>6.772337e+06</td>
      <td>3.870631e+06</td>
      <td>5.830141e+06</td>
      <td>2.235768e+05</td>
      <td>1.117884e+06</td>
      <td>5.589421e+06</td>
      <td>2.794710e+07</td>
    </tr>
    <tr>
      <th>9</th>
      <td>KHM</td>
      <td>Cambodia</td>
      <td>4.954698e+05</td>
      <td>5.731698e+05</td>
      <td>4.517045e+05</td>
      <td>5.592610e+05</td>
      <td>5.947277e+05</td>
      <td>6.412802e+05</td>
      <td>5.644891e+05</td>
      <td>1.238675e+07</td>
      <td>1.432925e+07</td>
      <td>1.129261e+07</td>
      <td>1.398153e+07</td>
      <td>1.486819e+07</td>
      <td>5.348666e+05</td>
      <td>2.674333e+06</td>
      <td>1.337166e+07</td>
      <td>6.685832e+07</td>
    </tr>
    <tr>
      <th>10</th>
      <td>KOR</td>
      <td>Korea (the Republic of)</td>
      <td>1.451878e+05</td>
      <td>1.274597e+05</td>
      <td>1.463222e+05</td>
      <td>1.293543e+05</td>
      <td>1.327782e+05</td>
      <td>1.165467e+05</td>
      <td>1.013006e+05</td>
      <td>3.629695e+06</td>
      <td>3.186493e+06</td>
      <td>3.658056e+06</td>
      <td>3.233858e+06</td>
      <td>3.319455e+06</td>
      <td>1.362205e+05</td>
      <td>6.811023e+05</td>
      <td>3.405512e+06</td>
      <td>1.702756e+07</td>
    </tr>
    <tr>
      <th>11</th>
      <td>LAO</td>
      <td>Lao People's Democratic Republic (the)</td>
      <td>1.661169e+04</td>
      <td>1.696441e+04</td>
      <td>1.168063e+04</td>
      <td>1.009675e+04</td>
      <td>1.461058e+04</td>
      <td>2.136270e+04</td>
      <td>1.475014e+04</td>
      <td>4.152924e+05</td>
      <td>4.241102e+05</td>
      <td>2.920158e+05</td>
      <td>2.524186e+05</td>
      <td>3.652645e+05</td>
      <td>1.399281e+04</td>
      <td>6.996406e+04</td>
      <td>3.498203e+05</td>
      <td>1.749102e+06</td>
    </tr>
    <tr>
      <th>12</th>
      <td>LKA</td>
      <td>Sri Lanka</td>
      <td>8.305626e+04</td>
      <td>1.011743e+05</td>
      <td>5.911841e+04</td>
      <td>9.018914e+04</td>
      <td>8.476088e+04</td>
      <td>9.248238e+04</td>
      <td>8.466966e+04</td>
      <td>2.076407e+06</td>
      <td>2.529358e+06</td>
      <td>1.477960e+06</td>
      <td>2.254728e+06</td>
      <td>2.119022e+06</td>
      <td>8.365981e+04</td>
      <td>4.182990e+05</td>
      <td>2.091495e+06</td>
      <td>1.045748e+07</td>
    </tr>
    <tr>
      <th>13</th>
      <td>MMR</td>
      <td>Myanmar</td>
      <td>1.132082e+06</td>
      <td>1.290806e+06</td>
      <td>1.205169e+06</td>
      <td>1.372447e+06</td>
      <td>1.256888e+06</td>
      <td>1.221904e+06</td>
      <td>1.289837e+06</td>
      <td>2.830206e+07</td>
      <td>3.227014e+07</td>
      <td>3.012923e+07</td>
      <td>3.431117e+07</td>
      <td>3.142221e+07</td>
      <td>1.251478e+06</td>
      <td>6.257392e+06</td>
      <td>3.128696e+07</td>
      <td>1.564348e+08</td>
    </tr>
    <tr>
      <th>14</th>
      <td>MYS</td>
      <td>Malaysia</td>
      <td>1.057399e+05</td>
      <td>1.110049e+05</td>
      <td>1.111291e+05</td>
      <td>1.066525e+05</td>
      <td>1.056287e+05</td>
      <td>1.127141e+05</td>
      <td>1.069696e+05</td>
      <td>2.643498e+06</td>
      <td>2.775123e+06</td>
      <td>2.778227e+06</td>
      <td>2.666313e+06</td>
      <td>2.640717e+06</td>
      <td>1.080310e+05</td>
      <td>5.401551e+05</td>
      <td>2.700775e+06</td>
      <td>1.350388e+07</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NPL</td>
      <td>Nepal</td>
      <td>1.007479e+05</td>
      <td>6.667161e+04</td>
      <td>8.081300e+04</td>
      <td>9.200752e+04</td>
      <td>1.164235e+05</td>
      <td>7.168401e+04</td>
      <td>4.811408e+04</td>
      <td>2.518697e+06</td>
      <td>1.666790e+06</td>
      <td>2.020325e+06</td>
      <td>2.300188e+06</td>
      <td>2.910588e+06</td>
      <td>9.133271e+04</td>
      <td>4.566635e+05</td>
      <td>2.283318e+06</td>
      <td>1.141659e+07</td>
    </tr>
    <tr>
      <th>16</th>
      <td>PAK</td>
      <td>Pakistan</td>
      <td>4.852431e+05</td>
      <td>5.945922e+05</td>
      <td>5.372641e+05</td>
      <td>4.532297e+05</td>
      <td>6.528548e+05</td>
      <td>6.401201e+05</td>
      <td>4.849205e+05</td>
      <td>1.213108e+07</td>
      <td>1.486480e+07</td>
      <td>1.343160e+07</td>
      <td>1.133074e+07</td>
      <td>1.632137e+07</td>
      <td>5.446368e+05</td>
      <td>2.723184e+06</td>
      <td>1.361592e+07</td>
      <td>6.807960e+07</td>
    </tr>
    <tr>
      <th>17</th>
      <td>PHL</td>
      <td>Philippines (the)</td>
      <td>3.432021e+05</td>
      <td>4.073554e+05</td>
      <td>3.836830e+05</td>
      <td>4.175210e+05</td>
      <td>3.584550e+05</td>
      <td>4.462836e+05</td>
      <td>4.383270e+05</td>
      <td>8.580052e+06</td>
      <td>1.018389e+07</td>
      <td>9.592074e+06</td>
      <td>1.043803e+07</td>
      <td>8.961374e+06</td>
      <td>3.820433e+05</td>
      <td>1.910216e+06</td>
      <td>9.551082e+06</td>
      <td>4.775541e+07</td>
    </tr>
    <tr>
      <th>18</th>
      <td>PRK</td>
      <td>Korea (the Democratic People's Republic of)</td>
      <td>1.143217e+05</td>
      <td>9.177653e+04</td>
      <td>1.085457e+05</td>
      <td>8.662578e+04</td>
      <td>9.655062e+04</td>
      <td>8.581038e+04</td>
      <td>7.735988e+04</td>
      <td>2.858041e+06</td>
      <td>2.294413e+06</td>
      <td>2.713641e+06</td>
      <td>2.165645e+06</td>
      <td>2.413765e+06</td>
      <td>9.956405e+04</td>
      <td>4.978202e+05</td>
      <td>2.489101e+06</td>
      <td>1.244551e+07</td>
    </tr>
    <tr>
      <th>19</th>
      <td>THA</td>
      <td>Thailand</td>
      <td>1.393798e+06</td>
      <td>1.780993e+06</td>
      <td>1.164699e+06</td>
      <td>9.166575e+05</td>
      <td>1.305046e+06</td>
      <td>1.520788e+06</td>
      <td>8.528673e+05</td>
      <td>3.484495e+07</td>
      <td>4.452483e+07</td>
      <td>2.911748e+07</td>
      <td>2.291644e+07</td>
      <td>3.262615e+07</td>
      <td>1.312239e+06</td>
      <td>6.561194e+06</td>
      <td>3.280597e+07</td>
      <td>1.640298e+08</td>
    </tr>
    <tr>
      <th>20</th>
      <td>TWN</td>
      <td>Taiwan (Province of China)</td>
      <td>7.866956e+04</td>
      <td>8.089149e+04</td>
      <td>8.705634e+04</td>
      <td>8.138151e+04</td>
      <td>8.990870e+04</td>
      <td>8.333327e+04</td>
      <td>6.619861e+04</td>
      <td>1.966739e+06</td>
      <td>2.022287e+06</td>
      <td>2.176408e+06</td>
      <td>2.034538e+06</td>
      <td>2.247717e+06</td>
      <td>8.358152e+04</td>
      <td>4.179076e+05</td>
      <td>2.089538e+06</td>
      <td>1.044769e+07</td>
    </tr>
    <tr>
      <th>21</th>
      <td>USA</td>
      <td>United States of America (the)</td>
      <td>1.611324e+05</td>
      <td>1.618576e+05</td>
      <td>1.684799e+05</td>
      <td>1.657254e+05</td>
      <td>1.691351e+05</td>
      <td>1.941455e+05</td>
      <td>1.634842e+05</td>
      <td>4.028310e+06</td>
      <td>4.046440e+06</td>
      <td>4.211999e+06</td>
      <td>4.143136e+06</td>
      <td>4.228377e+06</td>
      <td>1.652661e+05</td>
      <td>8.263305e+05</td>
      <td>4.131652e+06</td>
      <td>2.065826e+07</td>
    </tr>
    <tr>
      <th>22</th>
      <td>VNM</td>
      <td>Viet Nam</td>
      <td>1.346013e+06</td>
      <td>1.483777e+06</td>
      <td>1.406437e+06</td>
      <td>1.317455e+06</td>
      <td>1.269751e+06</td>
      <td>1.374450e+06</td>
      <td>1.502787e+06</td>
      <td>3.365033e+07</td>
      <td>3.709441e+07</td>
      <td>3.516092e+07</td>
      <td>3.293637e+07</td>
      <td>3.174377e+07</td>
      <td>1.364686e+06</td>
      <td>6.823432e+06</td>
      <td>3.411716e+07</td>
      <td>1.705858e+08</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="trace-country-merge">
<h3>TRACE Country Merge<a class="headerlink" href="#trace-country-merge" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace_merged_df</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">trace_emissions_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;iso3_country&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace_merged_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop_est</th>
      <th>continent</th>
      <th>name</th>
      <th>iso3_country</th>
      <th>gdp_md_est</th>
      <th>geometry</th>
      <th>country_name</th>
      <th>tCH4_2015</th>
      <th>tCH4_2016</th>
      <th>tCH4_2017</th>
      <th>...</th>
      <th>tCH4_2021</th>
      <th>tCO2_2015</th>
      <th>tCO2_2016</th>
      <th>tCO2_2017</th>
      <th>tCO2_2018</th>
      <th>tCO2_2019</th>
      <th>Mean_CH4</th>
      <th>Total_CH4</th>
      <th>Mean_CO2</th>
      <th>Total_CO2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>157826578</td>
      <td>Asia</td>
      <td>Bangladesh</td>
      <td>BGD</td>
      <td>628400.0</td>
      <td>POLYGON ((92.67272 22.04124, 92.65226 21.32405...</td>
      <td>Bangladesh</td>
      <td>2.344420e+06</td>
      <td>2.278158e+06</td>
      <td>2.098958e+06</td>
      <td>...</td>
      <td>1.983974e+06</td>
      <td>5.861049e+07</td>
      <td>5.695395e+07</td>
      <td>5.247394e+07</td>
      <td>5.353076e+07</td>
      <td>5.177463e+07</td>
      <td>2.186750e+06</td>
      <td>1.093375e+07</td>
      <td>5.466875e+07</td>
      <td>2.733438e+08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>207353391</td>
      <td>South America</td>
      <td>Brazil</td>
      <td>BRA</td>
      <td>3081000.0</td>
      <td>POLYGON ((-53.37366 -33.76838, -53.65054 -33.2...</td>
      <td>Brazil</td>
      <td>3.410233e+05</td>
      <td>3.104189e+05</td>
      <td>3.725173e+05</td>
      <td>...</td>
      <td>4.544874e+05</td>
      <td>8.525583e+06</td>
      <td>7.760473e+06</td>
      <td>9.312934e+06</td>
      <td>9.292575e+06</td>
      <td>8.236783e+06</td>
      <td>3.450268e+05</td>
      <td>1.725134e+06</td>
      <td>8.625670e+06</td>
      <td>4.312835e+07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1379302771</td>
      <td>Asia</td>
      <td>China</td>
      <td>CHN</td>
      <td>21140000.0</td>
      <td>MULTIPOLYGON (((109.47521 18.19770, 108.65521 ...</td>
      <td>China</td>
      <td>6.133647e+06</td>
      <td>5.859531e+06</td>
      <td>6.355071e+06</td>
      <td>...</td>
      <td>6.068210e+06</td>
      <td>1.533412e+08</td>
      <td>1.464883e+08</td>
      <td>1.588768e+08</td>
      <td>1.353491e+08</td>
      <td>1.400838e+08</td>
      <td>5.873113e+06</td>
      <td>2.936556e+07</td>
      <td>1.468278e+08</td>
      <td>7.341391e+08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48958159</td>
      <td>Europe</td>
      <td>Spain</td>
      <td>ESP</td>
      <td>1690000.0</td>
      <td>POLYGON ((-7.45373 37.09779, -7.53711 37.42890...</td>
      <td>Spain</td>
      <td>1.141464e+04</td>
      <td>1.334803e+04</td>
      <td>1.217299e+04</td>
      <td>...</td>
      <td>8.531579e+03</td>
      <td>2.853661e+05</td>
      <td>3.337007e+05</td>
      <td>3.043248e+05</td>
      <td>3.513524e+05</td>
      <td>2.870810e+05</td>
      <td>1.249460e+04</td>
      <td>6.247300e+04</td>
      <td>3.123650e+05</td>
      <td>1.561825e+06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>260580739</td>
      <td>Asia</td>
      <td>Indonesia</td>
      <td>IDN</td>
      <td>3028000.0</td>
      <td>MULTIPOLYGON (((141.00021 -2.60015, 141.01706 ...</td>
      <td>Indonesia</td>
      <td>1.283649e+06</td>
      <td>1.023129e+06</td>
      <td>9.615327e+05</td>
      <td>...</td>
      <td>1.009936e+06</td>
      <td>3.209122e+07</td>
      <td>2.557824e+07</td>
      <td>2.403832e+07</td>
      <td>2.942454e+07</td>
      <td>3.166670e+07</td>
      <td>1.142392e+06</td>
      <td>5.711960e+06</td>
      <td>2.855980e+07</td>
      <td>1.427990e+08</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1281935911</td>
      <td>Asia</td>
      <td>India</td>
      <td>IND</td>
      <td>8721000.0</td>
      <td>POLYGON ((97.32711 28.26158, 97.40256 27.88254...</td>
      <td>India</td>
      <td>6.219887e+06</td>
      <td>5.309413e+06</td>
      <td>6.228451e+06</td>
      <td>...</td>
      <td>6.567960e+06</td>
      <td>1.554972e+08</td>
      <td>1.327353e+08</td>
      <td>1.557113e+08</td>
      <td>1.647450e+08</td>
      <td>1.875389e+08</td>
      <td>6.369821e+06</td>
      <td>3.184910e+07</td>
      <td>1.592455e+08</td>
      <td>7.962276e+08</td>
    </tr>
    <tr>
      <th>6</th>
      <td>82021564</td>
      <td>Asia</td>
      <td>Iran</td>
      <td>IRN</td>
      <td>1459000.0</td>
      <td>POLYGON ((48.56797 29.92678, 48.01457 30.45246...</td>
      <td>Iran (Islamic Republic of)</td>
      <td>8.774407e+04</td>
      <td>9.180121e+04</td>
      <td>9.620217e+04</td>
      <td>...</td>
      <td>9.053525e+04</td>
      <td>2.193602e+06</td>
      <td>2.295030e+06</td>
      <td>2.405054e+06</td>
      <td>2.218936e+06</td>
      <td>2.375050e+06</td>
      <td>9.190138e+04</td>
      <td>4.595069e+05</td>
      <td>2.297534e+06</td>
      <td>1.148767e+07</td>
    </tr>
    <tr>
      <th>7</th>
      <td>62137802</td>
      <td>Europe</td>
      <td>Italy</td>
      <td>ITA</td>
      <td>2221000.0</td>
      <td>MULTIPOLYGON (((10.44270 46.89355, 11.04856 46...</td>
      <td>Italy</td>
      <td>4.995968e+04</td>
      <td>4.937785e+04</td>
      <td>5.443679e+04</td>
      <td>...</td>
      <td>5.089759e+04</td>
      <td>1.248992e+06</td>
      <td>1.234446e+06</td>
      <td>1.360920e+06</td>
      <td>1.117475e+06</td>
      <td>1.141729e+06</td>
      <td>4.882850e+04</td>
      <td>2.441425e+05</td>
      <td>1.220712e+06</td>
      <td>6.103562e+06</td>
    </tr>
    <tr>
      <th>8</th>
      <td>126451398</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>JPN</td>
      <td>4932000.0</td>
      <td>MULTIPOLYGON (((141.88460 39.18086, 140.95949 ...</td>
      <td>Japan</td>
      <td>2.305465e+05</td>
      <td>2.284133e+05</td>
      <td>2.708935e+05</td>
      <td>...</td>
      <td>1.574007e+05</td>
      <td>5.763662e+06</td>
      <td>5.710333e+06</td>
      <td>6.772337e+06</td>
      <td>3.870631e+06</td>
      <td>5.830141e+06</td>
      <td>2.235768e+05</td>
      <td>1.117884e+06</td>
      <td>5.589421e+06</td>
      <td>2.794710e+07</td>
    </tr>
    <tr>
      <th>9</th>
      <td>16204486</td>
      <td>Asia</td>
      <td>Cambodia</td>
      <td>KHM</td>
      <td>58940.0</td>
      <td>POLYGON ((102.58493 12.18659, 102.34810 13.394...</td>
      <td>Cambodia</td>
      <td>4.954698e+05</td>
      <td>5.731698e+05</td>
      <td>4.517045e+05</td>
      <td>...</td>
      <td>5.644891e+05</td>
      <td>1.238675e+07</td>
      <td>1.432925e+07</td>
      <td>1.129261e+07</td>
      <td>1.398153e+07</td>
      <td>1.486819e+07</td>
      <td>5.348666e+05</td>
      <td>2.674333e+06</td>
      <td>1.337166e+07</td>
      <td>6.685832e+07</td>
    </tr>
    <tr>
      <th>10</th>
      <td>51181299</td>
      <td>Asia</td>
      <td>South Korea</td>
      <td>KOR</td>
      <td>1929000.0</td>
      <td>POLYGON ((126.17476 37.74969, 126.23734 37.840...</td>
      <td>Korea (the Republic of)</td>
      <td>1.451878e+05</td>
      <td>1.274597e+05</td>
      <td>1.463222e+05</td>
      <td>...</td>
      <td>1.013006e+05</td>
      <td>3.629695e+06</td>
      <td>3.186493e+06</td>
      <td>3.658056e+06</td>
      <td>3.233858e+06</td>
      <td>3.319455e+06</td>
      <td>1.362205e+05</td>
      <td>6.811023e+05</td>
      <td>3.405512e+06</td>
      <td>1.702756e+07</td>
    </tr>
    <tr>
      <th>11</th>
      <td>7126706</td>
      <td>Asia</td>
      <td>Laos</td>
      <td>LAO</td>
      <td>40960.0</td>
      <td>POLYGON ((107.38273 14.20244, 106.49637 14.570...</td>
      <td>Lao People's Democratic Republic (the)</td>
      <td>1.661169e+04</td>
      <td>1.696441e+04</td>
      <td>1.168063e+04</td>
      <td>...</td>
      <td>1.475014e+04</td>
      <td>4.152924e+05</td>
      <td>4.241102e+05</td>
      <td>2.920158e+05</td>
      <td>2.524186e+05</td>
      <td>3.652645e+05</td>
      <td>1.399281e+04</td>
      <td>6.996406e+04</td>
      <td>3.498203e+05</td>
      <td>1.749102e+06</td>
    </tr>
    <tr>
      <th>12</th>
      <td>22409381</td>
      <td>Asia</td>
      <td>Sri Lanka</td>
      <td>LKA</td>
      <td>236700.0</td>
      <td>POLYGON ((81.78796 7.52306, 81.63732 6.48178, ...</td>
      <td>Sri Lanka</td>
      <td>8.305626e+04</td>
      <td>1.011743e+05</td>
      <td>5.911841e+04</td>
      <td>...</td>
      <td>8.466966e+04</td>
      <td>2.076407e+06</td>
      <td>2.529358e+06</td>
      <td>1.477960e+06</td>
      <td>2.254728e+06</td>
      <td>2.119022e+06</td>
      <td>8.365981e+04</td>
      <td>4.182990e+05</td>
      <td>2.091495e+06</td>
      <td>1.045748e+07</td>
    </tr>
    <tr>
      <th>13</th>
      <td>55123814</td>
      <td>Asia</td>
      <td>Myanmar</td>
      <td>MMR</td>
      <td>311100.0</td>
      <td>POLYGON ((100.11599 20.41785, 99.54331 20.1866...</td>
      <td>Myanmar</td>
      <td>1.132082e+06</td>
      <td>1.290806e+06</td>
      <td>1.205169e+06</td>
      <td>...</td>
      <td>1.289837e+06</td>
      <td>2.830206e+07</td>
      <td>3.227014e+07</td>
      <td>3.012923e+07</td>
      <td>3.431117e+07</td>
      <td>3.142221e+07</td>
      <td>1.251478e+06</td>
      <td>6.257392e+06</td>
      <td>3.128696e+07</td>
      <td>1.564348e+08</td>
    </tr>
    <tr>
      <th>14</th>
      <td>31381992</td>
      <td>Asia</td>
      <td>Malaysia</td>
      <td>MYS</td>
      <td>863000.0</td>
      <td>MULTIPOLYGON (((100.08576 6.46449, 100.25960 6...</td>
      <td>Malaysia</td>
      <td>1.057399e+05</td>
      <td>1.110049e+05</td>
      <td>1.111291e+05</td>
      <td>...</td>
      <td>1.069696e+05</td>
      <td>2.643498e+06</td>
      <td>2.775123e+06</td>
      <td>2.778227e+06</td>
      <td>2.666313e+06</td>
      <td>2.640717e+06</td>
      <td>1.080310e+05</td>
      <td>5.401551e+05</td>
      <td>2.700775e+06</td>
      <td>1.350388e+07</td>
    </tr>
    <tr>
      <th>15</th>
      <td>29384297</td>
      <td>Asia</td>
      <td>Nepal</td>
      <td>NPL</td>
      <td>71520.0</td>
      <td>POLYGON ((88.12044 27.87654, 88.04313 27.44582...</td>
      <td>Nepal</td>
      <td>1.007479e+05</td>
      <td>6.667161e+04</td>
      <td>8.081300e+04</td>
      <td>...</td>
      <td>4.811408e+04</td>
      <td>2.518697e+06</td>
      <td>1.666790e+06</td>
      <td>2.020325e+06</td>
      <td>2.300188e+06</td>
      <td>2.910588e+06</td>
      <td>9.133271e+04</td>
      <td>4.566635e+05</td>
      <td>2.283318e+06</td>
      <td>1.141659e+07</td>
    </tr>
    <tr>
      <th>16</th>
      <td>204924861</td>
      <td>Asia</td>
      <td>Pakistan</td>
      <td>PAK</td>
      <td>988200.0</td>
      <td>POLYGON ((77.83745 35.49401, 76.87172 34.65354...</td>
      <td>Pakistan</td>
      <td>4.852431e+05</td>
      <td>5.945922e+05</td>
      <td>5.372641e+05</td>
      <td>...</td>
      <td>4.849205e+05</td>
      <td>1.213108e+07</td>
      <td>1.486480e+07</td>
      <td>1.343160e+07</td>
      <td>1.133074e+07</td>
      <td>1.632137e+07</td>
      <td>5.446368e+05</td>
      <td>2.723184e+06</td>
      <td>1.361592e+07</td>
      <td>6.807960e+07</td>
    </tr>
    <tr>
      <th>17</th>
      <td>104256076</td>
      <td>Asia</td>
      <td>Philippines</td>
      <td>PHL</td>
      <td>801900.0</td>
      <td>MULTIPOLYGON (((120.83390 12.70450, 120.32344 ...</td>
      <td>Philippines (the)</td>
      <td>3.432021e+05</td>
      <td>4.073554e+05</td>
      <td>3.836830e+05</td>
      <td>...</td>
      <td>4.383270e+05</td>
      <td>8.580052e+06</td>
      <td>1.018389e+07</td>
      <td>9.592074e+06</td>
      <td>1.043803e+07</td>
      <td>8.961374e+06</td>
      <td>3.820433e+05</td>
      <td>1.910216e+06</td>
      <td>9.551082e+06</td>
      <td>4.775541e+07</td>
    </tr>
    <tr>
      <th>18</th>
      <td>25248140</td>
      <td>Asia</td>
      <td>North Korea</td>
      <td>PRK</td>
      <td>40000.0</td>
      <td>MULTIPOLYGON (((130.78000 42.22001, 130.78000 ...</td>
      <td>Korea (the Democratic People's Republic of)</td>
      <td>1.143217e+05</td>
      <td>9.177653e+04</td>
      <td>1.085457e+05</td>
      <td>...</td>
      <td>7.735988e+04</td>
      <td>2.858041e+06</td>
      <td>2.294413e+06</td>
      <td>2.713641e+06</td>
      <td>2.165645e+06</td>
      <td>2.413765e+06</td>
      <td>9.956405e+04</td>
      <td>4.978202e+05</td>
      <td>2.489101e+06</td>
      <td>1.244551e+07</td>
    </tr>
    <tr>
      <th>19</th>
      <td>68414135</td>
      <td>Asia</td>
      <td>Thailand</td>
      <td>THA</td>
      <td>1161000.0</td>
      <td>POLYGON ((105.21878 14.27321, 104.28142 14.416...</td>
      <td>Thailand</td>
      <td>1.393798e+06</td>
      <td>1.780993e+06</td>
      <td>1.164699e+06</td>
      <td>...</td>
      <td>8.528673e+05</td>
      <td>3.484495e+07</td>
      <td>4.452483e+07</td>
      <td>2.911748e+07</td>
      <td>2.291644e+07</td>
      <td>3.262615e+07</td>
      <td>1.312239e+06</td>
      <td>6.561194e+06</td>
      <td>3.280597e+07</td>
      <td>1.640298e+08</td>
    </tr>
    <tr>
      <th>20</th>
      <td>23508428</td>
      <td>Asia</td>
      <td>Taiwan</td>
      <td>TWN</td>
      <td>1127000.0</td>
      <td>POLYGON ((121.77782 24.39427, 121.17563 22.790...</td>
      <td>Taiwan (Province of China)</td>
      <td>7.866956e+04</td>
      <td>8.089149e+04</td>
      <td>8.705634e+04</td>
      <td>...</td>
      <td>6.619861e+04</td>
      <td>1.966739e+06</td>
      <td>2.022287e+06</td>
      <td>2.176408e+06</td>
      <td>2.034538e+06</td>
      <td>2.247717e+06</td>
      <td>8.358152e+04</td>
      <td>4.179076e+05</td>
      <td>2.089538e+06</td>
      <td>1.044769e+07</td>
    </tr>
    <tr>
      <th>21</th>
      <td>326625791</td>
      <td>North America</td>
      <td>United States of America</td>
      <td>USA</td>
      <td>18560000.0</td>
      <td>MULTIPOLYGON (((-122.84000 49.00000, -120.0000...</td>
      <td>United States of America (the)</td>
      <td>1.611324e+05</td>
      <td>1.618576e+05</td>
      <td>1.684799e+05</td>
      <td>...</td>
      <td>1.634842e+05</td>
      <td>4.028310e+06</td>
      <td>4.046440e+06</td>
      <td>4.211999e+06</td>
      <td>4.143136e+06</td>
      <td>4.228377e+06</td>
      <td>1.652661e+05</td>
      <td>8.263305e+05</td>
      <td>4.131652e+06</td>
      <td>2.065826e+07</td>
    </tr>
    <tr>
      <th>22</th>
      <td>96160163</td>
      <td>Asia</td>
      <td>Vietnam</td>
      <td>VNM</td>
      <td>594900.0</td>
      <td>POLYGON ((104.33433 10.48654, 105.19991 10.889...</td>
      <td>Viet Nam</td>
      <td>1.346013e+06</td>
      <td>1.483777e+06</td>
      <td>1.406437e+06</td>
      <td>...</td>
      <td>1.502787e+06</td>
      <td>3.365033e+07</td>
      <td>3.709441e+07</td>
      <td>3.516092e+07</td>
      <td>3.293637e+07</td>
      <td>3.174377e+07</td>
      <td>1.364686e+06</td>
      <td>6.823432e+06</td>
      <td>3.411716e+07</td>
      <td>1.705858e+08</td>
    </tr>
  </tbody>
</table>
<p>23 rows × 23 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace_merged_df</span> <span class="o">=</span> <span class="n">trace_merged_df</span><span class="p">[</span><span class="n">trace_merged_df</span><span class="p">[</span><span class="s1">&#39;continent&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Antarctica&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace_merged_df</span>
<span class="c1">#trace_merged_df.dropna(axis=1, how=&#39;any&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop_est</th>
      <th>continent</th>
      <th>name</th>
      <th>iso3_country</th>
      <th>gdp_md_est</th>
      <th>geometry</th>
      <th>country_name</th>
      <th>tCH4_2015</th>
      <th>tCH4_2016</th>
      <th>tCH4_2017</th>
      <th>...</th>
      <th>tCH4_2021</th>
      <th>tCO2_2015</th>
      <th>tCO2_2016</th>
      <th>tCO2_2017</th>
      <th>tCO2_2018</th>
      <th>tCO2_2019</th>
      <th>Mean_CH4</th>
      <th>Total_CH4</th>
      <th>Mean_CO2</th>
      <th>Total_CO2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>157826578</td>
      <td>Asia</td>
      <td>Bangladesh</td>
      <td>BGD</td>
      <td>628400.0</td>
      <td>POLYGON ((92.67272 22.04124, 92.65226 21.32405...</td>
      <td>Bangladesh</td>
      <td>2.344420e+06</td>
      <td>2.278158e+06</td>
      <td>2.098958e+06</td>
      <td>...</td>
      <td>1.983974e+06</td>
      <td>5.861049e+07</td>
      <td>5.695395e+07</td>
      <td>5.247394e+07</td>
      <td>5.353076e+07</td>
      <td>5.177463e+07</td>
      <td>2.186750e+06</td>
      <td>1.093375e+07</td>
      <td>5.466875e+07</td>
      <td>2.733438e+08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>207353391</td>
      <td>South America</td>
      <td>Brazil</td>
      <td>BRA</td>
      <td>3081000.0</td>
      <td>POLYGON ((-53.37366 -33.76838, -53.65054 -33.2...</td>
      <td>Brazil</td>
      <td>3.410233e+05</td>
      <td>3.104189e+05</td>
      <td>3.725173e+05</td>
      <td>...</td>
      <td>4.544874e+05</td>
      <td>8.525583e+06</td>
      <td>7.760473e+06</td>
      <td>9.312934e+06</td>
      <td>9.292575e+06</td>
      <td>8.236783e+06</td>
      <td>3.450268e+05</td>
      <td>1.725134e+06</td>
      <td>8.625670e+06</td>
      <td>4.312835e+07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1379302771</td>
      <td>Asia</td>
      <td>China</td>
      <td>CHN</td>
      <td>21140000.0</td>
      <td>MULTIPOLYGON (((109.47521 18.19770, 108.65521 ...</td>
      <td>China</td>
      <td>6.133647e+06</td>
      <td>5.859531e+06</td>
      <td>6.355071e+06</td>
      <td>...</td>
      <td>6.068210e+06</td>
      <td>1.533412e+08</td>
      <td>1.464883e+08</td>
      <td>1.588768e+08</td>
      <td>1.353491e+08</td>
      <td>1.400838e+08</td>
      <td>5.873113e+06</td>
      <td>2.936556e+07</td>
      <td>1.468278e+08</td>
      <td>7.341391e+08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>48958159</td>
      <td>Europe</td>
      <td>Spain</td>
      <td>ESP</td>
      <td>1690000.0</td>
      <td>POLYGON ((-7.45373 37.09779, -7.53711 37.42890...</td>
      <td>Spain</td>
      <td>1.141464e+04</td>
      <td>1.334803e+04</td>
      <td>1.217299e+04</td>
      <td>...</td>
      <td>8.531579e+03</td>
      <td>2.853661e+05</td>
      <td>3.337007e+05</td>
      <td>3.043248e+05</td>
      <td>3.513524e+05</td>
      <td>2.870810e+05</td>
      <td>1.249460e+04</td>
      <td>6.247300e+04</td>
      <td>3.123650e+05</td>
      <td>1.561825e+06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>260580739</td>
      <td>Asia</td>
      <td>Indonesia</td>
      <td>IDN</td>
      <td>3028000.0</td>
      <td>MULTIPOLYGON (((141.00021 -2.60015, 141.01706 ...</td>
      <td>Indonesia</td>
      <td>1.283649e+06</td>
      <td>1.023129e+06</td>
      <td>9.615327e+05</td>
      <td>...</td>
      <td>1.009936e+06</td>
      <td>3.209122e+07</td>
      <td>2.557824e+07</td>
      <td>2.403832e+07</td>
      <td>2.942454e+07</td>
      <td>3.166670e+07</td>
      <td>1.142392e+06</td>
      <td>5.711960e+06</td>
      <td>2.855980e+07</td>
      <td>1.427990e+08</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1281935911</td>
      <td>Asia</td>
      <td>India</td>
      <td>IND</td>
      <td>8721000.0</td>
      <td>POLYGON ((97.32711 28.26158, 97.40256 27.88254...</td>
      <td>India</td>
      <td>6.219887e+06</td>
      <td>5.309413e+06</td>
      <td>6.228451e+06</td>
      <td>...</td>
      <td>6.567960e+06</td>
      <td>1.554972e+08</td>
      <td>1.327353e+08</td>
      <td>1.557113e+08</td>
      <td>1.647450e+08</td>
      <td>1.875389e+08</td>
      <td>6.369821e+06</td>
      <td>3.184910e+07</td>
      <td>1.592455e+08</td>
      <td>7.962276e+08</td>
    </tr>
    <tr>
      <th>6</th>
      <td>82021564</td>
      <td>Asia</td>
      <td>Iran</td>
      <td>IRN</td>
      <td>1459000.0</td>
      <td>POLYGON ((48.56797 29.92678, 48.01457 30.45246...</td>
      <td>Iran (Islamic Republic of)</td>
      <td>8.774407e+04</td>
      <td>9.180121e+04</td>
      <td>9.620217e+04</td>
      <td>...</td>
      <td>9.053525e+04</td>
      <td>2.193602e+06</td>
      <td>2.295030e+06</td>
      <td>2.405054e+06</td>
      <td>2.218936e+06</td>
      <td>2.375050e+06</td>
      <td>9.190138e+04</td>
      <td>4.595069e+05</td>
      <td>2.297534e+06</td>
      <td>1.148767e+07</td>
    </tr>
    <tr>
      <th>7</th>
      <td>62137802</td>
      <td>Europe</td>
      <td>Italy</td>
      <td>ITA</td>
      <td>2221000.0</td>
      <td>MULTIPOLYGON (((10.44270 46.89355, 11.04856 46...</td>
      <td>Italy</td>
      <td>4.995968e+04</td>
      <td>4.937785e+04</td>
      <td>5.443679e+04</td>
      <td>...</td>
      <td>5.089759e+04</td>
      <td>1.248992e+06</td>
      <td>1.234446e+06</td>
      <td>1.360920e+06</td>
      <td>1.117475e+06</td>
      <td>1.141729e+06</td>
      <td>4.882850e+04</td>
      <td>2.441425e+05</td>
      <td>1.220712e+06</td>
      <td>6.103562e+06</td>
    </tr>
    <tr>
      <th>8</th>
      <td>126451398</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>JPN</td>
      <td>4932000.0</td>
      <td>MULTIPOLYGON (((141.88460 39.18086, 140.95949 ...</td>
      <td>Japan</td>
      <td>2.305465e+05</td>
      <td>2.284133e+05</td>
      <td>2.708935e+05</td>
      <td>...</td>
      <td>1.574007e+05</td>
      <td>5.763662e+06</td>
      <td>5.710333e+06</td>
      <td>6.772337e+06</td>
      <td>3.870631e+06</td>
      <td>5.830141e+06</td>
      <td>2.235768e+05</td>
      <td>1.117884e+06</td>
      <td>5.589421e+06</td>
      <td>2.794710e+07</td>
    </tr>
    <tr>
      <th>9</th>
      <td>16204486</td>
      <td>Asia</td>
      <td>Cambodia</td>
      <td>KHM</td>
      <td>58940.0</td>
      <td>POLYGON ((102.58493 12.18659, 102.34810 13.394...</td>
      <td>Cambodia</td>
      <td>4.954698e+05</td>
      <td>5.731698e+05</td>
      <td>4.517045e+05</td>
      <td>...</td>
      <td>5.644891e+05</td>
      <td>1.238675e+07</td>
      <td>1.432925e+07</td>
      <td>1.129261e+07</td>
      <td>1.398153e+07</td>
      <td>1.486819e+07</td>
      <td>5.348666e+05</td>
      <td>2.674333e+06</td>
      <td>1.337166e+07</td>
      <td>6.685832e+07</td>
    </tr>
    <tr>
      <th>10</th>
      <td>51181299</td>
      <td>Asia</td>
      <td>South Korea</td>
      <td>KOR</td>
      <td>1929000.0</td>
      <td>POLYGON ((126.17476 37.74969, 126.23734 37.840...</td>
      <td>Korea (the Republic of)</td>
      <td>1.451878e+05</td>
      <td>1.274597e+05</td>
      <td>1.463222e+05</td>
      <td>...</td>
      <td>1.013006e+05</td>
      <td>3.629695e+06</td>
      <td>3.186493e+06</td>
      <td>3.658056e+06</td>
      <td>3.233858e+06</td>
      <td>3.319455e+06</td>
      <td>1.362205e+05</td>
      <td>6.811023e+05</td>
      <td>3.405512e+06</td>
      <td>1.702756e+07</td>
    </tr>
    <tr>
      <th>11</th>
      <td>7126706</td>
      <td>Asia</td>
      <td>Laos</td>
      <td>LAO</td>
      <td>40960.0</td>
      <td>POLYGON ((107.38273 14.20244, 106.49637 14.570...</td>
      <td>Lao People's Democratic Republic (the)</td>
      <td>1.661169e+04</td>
      <td>1.696441e+04</td>
      <td>1.168063e+04</td>
      <td>...</td>
      <td>1.475014e+04</td>
      <td>4.152924e+05</td>
      <td>4.241102e+05</td>
      <td>2.920158e+05</td>
      <td>2.524186e+05</td>
      <td>3.652645e+05</td>
      <td>1.399281e+04</td>
      <td>6.996406e+04</td>
      <td>3.498203e+05</td>
      <td>1.749102e+06</td>
    </tr>
    <tr>
      <th>12</th>
      <td>22409381</td>
      <td>Asia</td>
      <td>Sri Lanka</td>
      <td>LKA</td>
      <td>236700.0</td>
      <td>POLYGON ((81.78796 7.52306, 81.63732 6.48178, ...</td>
      <td>Sri Lanka</td>
      <td>8.305626e+04</td>
      <td>1.011743e+05</td>
      <td>5.911841e+04</td>
      <td>...</td>
      <td>8.466966e+04</td>
      <td>2.076407e+06</td>
      <td>2.529358e+06</td>
      <td>1.477960e+06</td>
      <td>2.254728e+06</td>
      <td>2.119022e+06</td>
      <td>8.365981e+04</td>
      <td>4.182990e+05</td>
      <td>2.091495e+06</td>
      <td>1.045748e+07</td>
    </tr>
    <tr>
      <th>13</th>
      <td>55123814</td>
      <td>Asia</td>
      <td>Myanmar</td>
      <td>MMR</td>
      <td>311100.0</td>
      <td>POLYGON ((100.11599 20.41785, 99.54331 20.1866...</td>
      <td>Myanmar</td>
      <td>1.132082e+06</td>
      <td>1.290806e+06</td>
      <td>1.205169e+06</td>
      <td>...</td>
      <td>1.289837e+06</td>
      <td>2.830206e+07</td>
      <td>3.227014e+07</td>
      <td>3.012923e+07</td>
      <td>3.431117e+07</td>
      <td>3.142221e+07</td>
      <td>1.251478e+06</td>
      <td>6.257392e+06</td>
      <td>3.128696e+07</td>
      <td>1.564348e+08</td>
    </tr>
    <tr>
      <th>14</th>
      <td>31381992</td>
      <td>Asia</td>
      <td>Malaysia</td>
      <td>MYS</td>
      <td>863000.0</td>
      <td>MULTIPOLYGON (((100.08576 6.46449, 100.25960 6...</td>
      <td>Malaysia</td>
      <td>1.057399e+05</td>
      <td>1.110049e+05</td>
      <td>1.111291e+05</td>
      <td>...</td>
      <td>1.069696e+05</td>
      <td>2.643498e+06</td>
      <td>2.775123e+06</td>
      <td>2.778227e+06</td>
      <td>2.666313e+06</td>
      <td>2.640717e+06</td>
      <td>1.080310e+05</td>
      <td>5.401551e+05</td>
      <td>2.700775e+06</td>
      <td>1.350388e+07</td>
    </tr>
    <tr>
      <th>15</th>
      <td>29384297</td>
      <td>Asia</td>
      <td>Nepal</td>
      <td>NPL</td>
      <td>71520.0</td>
      <td>POLYGON ((88.12044 27.87654, 88.04313 27.44582...</td>
      <td>Nepal</td>
      <td>1.007479e+05</td>
      <td>6.667161e+04</td>
      <td>8.081300e+04</td>
      <td>...</td>
      <td>4.811408e+04</td>
      <td>2.518697e+06</td>
      <td>1.666790e+06</td>
      <td>2.020325e+06</td>
      <td>2.300188e+06</td>
      <td>2.910588e+06</td>
      <td>9.133271e+04</td>
      <td>4.566635e+05</td>
      <td>2.283318e+06</td>
      <td>1.141659e+07</td>
    </tr>
    <tr>
      <th>16</th>
      <td>204924861</td>
      <td>Asia</td>
      <td>Pakistan</td>
      <td>PAK</td>
      <td>988200.0</td>
      <td>POLYGON ((77.83745 35.49401, 76.87172 34.65354...</td>
      <td>Pakistan</td>
      <td>4.852431e+05</td>
      <td>5.945922e+05</td>
      <td>5.372641e+05</td>
      <td>...</td>
      <td>4.849205e+05</td>
      <td>1.213108e+07</td>
      <td>1.486480e+07</td>
      <td>1.343160e+07</td>
      <td>1.133074e+07</td>
      <td>1.632137e+07</td>
      <td>5.446368e+05</td>
      <td>2.723184e+06</td>
      <td>1.361592e+07</td>
      <td>6.807960e+07</td>
    </tr>
    <tr>
      <th>17</th>
      <td>104256076</td>
      <td>Asia</td>
      <td>Philippines</td>
      <td>PHL</td>
      <td>801900.0</td>
      <td>MULTIPOLYGON (((120.83390 12.70450, 120.32344 ...</td>
      <td>Philippines (the)</td>
      <td>3.432021e+05</td>
      <td>4.073554e+05</td>
      <td>3.836830e+05</td>
      <td>...</td>
      <td>4.383270e+05</td>
      <td>8.580052e+06</td>
      <td>1.018389e+07</td>
      <td>9.592074e+06</td>
      <td>1.043803e+07</td>
      <td>8.961374e+06</td>
      <td>3.820433e+05</td>
      <td>1.910216e+06</td>
      <td>9.551082e+06</td>
      <td>4.775541e+07</td>
    </tr>
    <tr>
      <th>18</th>
      <td>25248140</td>
      <td>Asia</td>
      <td>North Korea</td>
      <td>PRK</td>
      <td>40000.0</td>
      <td>MULTIPOLYGON (((130.78000 42.22001, 130.78000 ...</td>
      <td>Korea (the Democratic People's Republic of)</td>
      <td>1.143217e+05</td>
      <td>9.177653e+04</td>
      <td>1.085457e+05</td>
      <td>...</td>
      <td>7.735988e+04</td>
      <td>2.858041e+06</td>
      <td>2.294413e+06</td>
      <td>2.713641e+06</td>
      <td>2.165645e+06</td>
      <td>2.413765e+06</td>
      <td>9.956405e+04</td>
      <td>4.978202e+05</td>
      <td>2.489101e+06</td>
      <td>1.244551e+07</td>
    </tr>
    <tr>
      <th>19</th>
      <td>68414135</td>
      <td>Asia</td>
      <td>Thailand</td>
      <td>THA</td>
      <td>1161000.0</td>
      <td>POLYGON ((105.21878 14.27321, 104.28142 14.416...</td>
      <td>Thailand</td>
      <td>1.393798e+06</td>
      <td>1.780993e+06</td>
      <td>1.164699e+06</td>
      <td>...</td>
      <td>8.528673e+05</td>
      <td>3.484495e+07</td>
      <td>4.452483e+07</td>
      <td>2.911748e+07</td>
      <td>2.291644e+07</td>
      <td>3.262615e+07</td>
      <td>1.312239e+06</td>
      <td>6.561194e+06</td>
      <td>3.280597e+07</td>
      <td>1.640298e+08</td>
    </tr>
    <tr>
      <th>20</th>
      <td>23508428</td>
      <td>Asia</td>
      <td>Taiwan</td>
      <td>TWN</td>
      <td>1127000.0</td>
      <td>POLYGON ((121.77782 24.39427, 121.17563 22.790...</td>
      <td>Taiwan (Province of China)</td>
      <td>7.866956e+04</td>
      <td>8.089149e+04</td>
      <td>8.705634e+04</td>
      <td>...</td>
      <td>6.619861e+04</td>
      <td>1.966739e+06</td>
      <td>2.022287e+06</td>
      <td>2.176408e+06</td>
      <td>2.034538e+06</td>
      <td>2.247717e+06</td>
      <td>8.358152e+04</td>
      <td>4.179076e+05</td>
      <td>2.089538e+06</td>
      <td>1.044769e+07</td>
    </tr>
    <tr>
      <th>21</th>
      <td>326625791</td>
      <td>North America</td>
      <td>United States of America</td>
      <td>USA</td>
      <td>18560000.0</td>
      <td>MULTIPOLYGON (((-122.84000 49.00000, -120.0000...</td>
      <td>United States of America (the)</td>
      <td>1.611324e+05</td>
      <td>1.618576e+05</td>
      <td>1.684799e+05</td>
      <td>...</td>
      <td>1.634842e+05</td>
      <td>4.028310e+06</td>
      <td>4.046440e+06</td>
      <td>4.211999e+06</td>
      <td>4.143136e+06</td>
      <td>4.228377e+06</td>
      <td>1.652661e+05</td>
      <td>8.263305e+05</td>
      <td>4.131652e+06</td>
      <td>2.065826e+07</td>
    </tr>
    <tr>
      <th>22</th>
      <td>96160163</td>
      <td>Asia</td>
      <td>Vietnam</td>
      <td>VNM</td>
      <td>594900.0</td>
      <td>POLYGON ((104.33433 10.48654, 105.19991 10.889...</td>
      <td>Viet Nam</td>
      <td>1.346013e+06</td>
      <td>1.483777e+06</td>
      <td>1.406437e+06</td>
      <td>...</td>
      <td>1.502787e+06</td>
      <td>3.365033e+07</td>
      <td>3.709441e+07</td>
      <td>3.516092e+07</td>
      <td>3.293637e+07</td>
      <td>3.174377e+07</td>
      <td>1.364686e+06</td>
      <td>6.823432e+06</td>
      <td>3.411716e+07</td>
      <td>1.705858e+08</td>
    </tr>
  </tbody>
</table>
<p>23 rows × 23 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="trace-merge-to-file">
<h3>Trace Merge to File<a class="headerlink" href="#trace-merge-to-file" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gisout</span> <span class="o">=</span> <span class="s2">&quot;/Users/jnapolitano/Projects/wattime-takehome/data/TRACE_DATA_GEO.geojson&quot;</span>
<span class="n">trace_merged_df</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">gisout</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/jnapolitano/venvs/finance/lib/python3.9/site-packages/geopandas/io/file.py:362: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  pd.Int64Index,
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="merge-geo-data">
<h2>Merge GEO DATA<a class="headerlink" href="#merge-geo-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;/Users/jnapolitano/Projects/wattime-takehome/data/MERGED_DATA.csv&quot;</span>

<span class="n">merged_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

<span class="n">merged_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_countries</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_data</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;iso3_country&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_countries</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop_est</th>
      <th>continent</th>
      <th>name</th>
      <th>iso3_country</th>
      <th>gdp_md_est</th>
      <th>geometry</th>
      <th>country_name_FAOSTAT</th>
      <th>2015</th>
      <th>2016</th>
      <th>2017</th>
      <th>...</th>
      <th>CO2_abs_percent_diff_2019</th>
      <th>CO2_abs_percent_diff_means</th>
      <th>CO2_abs_percent_diff_totals</th>
      <th>CO2_relative_percent_diff_2015</th>
      <th>CO2_relative_percent_diff_2016</th>
      <th>CO2_relative_percent_diff_2017</th>
      <th>CO2_relative_percent_diff_2018</th>
      <th>CO2_relative_percent_diff_2019</th>
      <th>CO2_relative_percent_diff_means</th>
      <th>CO2_relative_percent_diff_totals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.578266e+08</td>
      <td>Asia</td>
      <td>Bangladesh</td>
      <td>BGD</td>
      <td>628400.0</td>
      <td>POLYGON ((92.67272 22.04124, 92.65226 21.32405...</td>
      <td>Bangladesh</td>
      <td>1131293.4</td>
      <td>1.093480e+06</td>
      <td>1.154531e+06</td>
      <td>...</td>
      <td>57.606797</td>
      <td>63.425917</td>
      <td>63.425917</td>
      <td>-107.233570</td>
      <td>-108.340089</td>
      <td>-81.801753</td>
      <td>-87.073857</td>
      <td>-80.912284</td>
      <td>-92.881337</td>
      <td>-92.881337</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.073534e+08</td>
      <td>South America</td>
      <td>Brazil</td>
      <td>BRA</td>
      <td>3081000.0</td>
      <td>POLYGON ((-53.37366 -33.76838, -53.65054 -33.2...</td>
      <td>Brazil</td>
      <td>138910.3</td>
      <td>1.262782e+05</td>
      <td>1.303229e+05</td>
      <td>...</td>
      <td>99.141295</td>
      <td>93.222402</td>
      <td>93.222402</td>
      <td>-145.498958</td>
      <td>-145.821472</td>
      <td>-185.841820</td>
      <td>-205.638590</td>
      <td>-196.594424</td>
      <td>-174.610414</td>
      <td>-174.610414</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.379303e+09</td>
      <td>Asia</td>
      <td>China</td>
      <td>CHN</td>
      <td>21140000.0</td>
      <td>MULTIPOLYGON (((109.47521 18.19770, 108.65521 ...</td>
      <td>China</td>
      <td>5406593.9</td>
      <td>5.399920e+06</td>
      <td>5.400129e+06</td>
      <td>...</td>
      <td>7.189945</td>
      <td>9.421813</td>
      <td>9.421813</td>
      <td>-13.447527</td>
      <td>-8.511442</td>
      <td>-17.683689</td>
      <td>-2.108366</td>
      <td>-7.458060</td>
      <td>-9.887609</td>
      <td>-9.887609</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.895816e+07</td>
      <td>Europe</td>
      <td>Spain</td>
      <td>ESP</td>
      <td>1690000.0</td>
      <td>POLYGON ((-7.45373 37.09779, -7.53711 37.42890...</td>
      <td>Spain</td>
      <td>55082.2</td>
      <td>5.507310e+04</td>
      <td>5.423240e+04</td>
      <td>...</td>
      <td>127.757634</td>
      <td>124.705066</td>
      <td>124.705066</td>
      <td>79.277072</td>
      <td>75.763074</td>
      <td>77.554025</td>
      <td>73.445258</td>
      <td>77.958601</td>
      <td>76.811284</td>
      <td>76.811284</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.605807e+08</td>
      <td>Asia</td>
      <td>Indonesia</td>
      <td>IDN</td>
      <td>3028000.0</td>
      <td>MULTIPOLYGON (((141.00021 -2.60015, 141.01706 ...</td>
      <td>Indonesia</td>
      <td>2407953.5</td>
      <td>2.387656e+06</td>
      <td>2.425291e+06</td>
      <td>...</td>
      <td>56.234955</td>
      <td>70.153790</td>
      <td>70.153790</td>
      <td>46.691296</td>
      <td>57.149216</td>
      <td>60.353916</td>
      <td>51.073546</td>
      <td>43.893273</td>
      <td>51.936188</td>
      <td>51.936188</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.281936e+09</td>
      <td>Asia</td>
      <td>India</td>
      <td>IND</td>
      <td>8721000.0</td>
      <td>POLYGON ((97.32711 28.26158, 97.40256 27.88254...</td>
      <td>India</td>
      <td>4580248.4</td>
      <td>4.559136e+06</td>
      <td>4.620791e+06</td>
      <td>...</td>
      <td>47.515394</td>
      <td>32.086209</td>
      <td>32.086209</td>
      <td>-35.798018</td>
      <td>-16.456550</td>
      <td>-34.791882</td>
      <td>-41.376939</td>
      <td>-62.321563</td>
      <td>-38.217479</td>
      <td>-38.217479</td>
    </tr>
    <tr>
      <th>6</th>
      <td>8.202156e+07</td>
      <td>Asia</td>
      <td>Iran</td>
      <td>IRN</td>
      <td>1459000.0</td>
      <td>POLYGON ((48.56797 29.92678, 48.01457 30.45246...</td>
      <td>Iran (Islamic Republic of)</td>
      <td>116486.7</td>
      <td>1.310085e+05</td>
      <td>8.723360e+04</td>
      <td>...</td>
      <td>1.152675</td>
      <td>13.260902</td>
      <td>13.260902</td>
      <td>24.674600</td>
      <td>29.927285</td>
      <td>-10.281098</td>
      <td>5.513463</td>
      <td>1.146070</td>
      <td>12.436318</td>
      <td>12.436318</td>
    </tr>
    <tr>
      <th>7</th>
      <td>6.213780e+07</td>
      <td>Europe</td>
      <td>Italy</td>
      <td>ITA</td>
      <td>2221000.0</td>
      <td>MULTIPOLYGON (((10.44270 46.89355, 11.04856 46...</td>
      <td>Italy</td>
      <td>114574.8</td>
      <td>1.180030e+05</td>
      <td>1.180030e+05</td>
      <td>...</td>
      <td>83.321649</td>
      <td>80.187551</td>
      <td>80.187551</td>
      <td>56.395576</td>
      <td>58.155426</td>
      <td>53.868303</td>
      <td>59.165480</td>
      <td>58.817707</td>
      <td>57.238482</td>
      <td>57.238482</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.264514e+08</td>
      <td>Asia</td>
      <td>Japan</td>
      <td>JPN</td>
      <td>4932000.0</td>
      <td>MULTIPOLYGON (((141.88460 39.18086, 140.95949 ...</td>
      <td>Japan</td>
      <td>330353.1</td>
      <td>3.264030e+05</td>
      <td>3.237003e+05</td>
      <td>...</td>
      <td>31.555853</td>
      <td>36.874729</td>
      <td>36.874729</td>
      <td>30.212099</td>
      <td>30.021068</td>
      <td>16.313490</td>
      <td>51.954183</td>
      <td>27.255501</td>
      <td>31.134372</td>
      <td>31.134372</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1.620449e+07</td>
      <td>Asia</td>
      <td>Cambodia</td>
      <td>KHM</td>
      <td>58940.0</td>
      <td>POLYGON ((102.58493 12.18659, 102.34810 13.394...</td>
      <td>Cambodia</td>
      <td>436826.0</td>
      <td>4.590031e+05</td>
      <td>4.737453e+05</td>
      <td>...</td>
      <td>23.769728</td>
      <td>14.304565</td>
      <td>14.304565</td>
      <td>-13.424988</td>
      <td>-24.872761</td>
      <td>4.652461</td>
      <td>-16.667610</td>
      <td>-26.975760</td>
      <td>-15.406481</td>
      <td>-15.406481</td>
    </tr>
    <tr>
      <th>10</th>
      <td>5.118130e+07</td>
      <td>Asia</td>
      <td>South Korea</td>
      <td>KOR</td>
      <td>1929000.0</td>
      <td>POLYGON ((126.17476 37.74969, 126.23734 37.840...</td>
      <td>Korea (the Republic of)</td>
      <td>167862.2</td>
      <td>1.635341e+05</td>
      <td>1.584897e+05</td>
      <td>...</td>
      <td>14.321600</td>
      <td>15.813819</td>
      <td>15.813819</td>
      <td>13.507737</td>
      <td>22.059230</td>
      <td>7.677136</td>
      <td>16.497815</td>
      <td>13.364589</td>
      <td>14.655057</td>
      <td>14.655057</td>
    </tr>
    <tr>
      <th>11</th>
      <td>7.126706e+06</td>
      <td>Asia</td>
      <td>Laos</td>
      <td>LAO</td>
      <td>40960.0</td>
      <td>POLYGON ((107.38273 14.20244, 106.49637 14.570...</td>
      <td>Lao People's Democratic Republic (the)</td>
      <td>94826.8</td>
      <td>9.563000e+04</td>
      <td>9.394070e+04</td>
      <td>...</td>
      <td>136.209544</td>
      <td>145.627378</td>
      <td>145.627378</td>
      <td>82.482067</td>
      <td>82.260369</td>
      <td>87.565950</td>
      <td>87.883944</td>
      <td>81.026578</td>
      <td>84.268427</td>
      <td>84.268427</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2.240938e+07</td>
      <td>Asia</td>
      <td>Sri Lanka</td>
      <td>LKA</td>
      <td>236700.0</td>
      <td>POLYGON ((81.78796 7.52306, 81.63732 6.48178, ...</td>
      <td>Sri Lanka</td>
      <td>132640.0</td>
      <td>1.217563e+05</td>
      <td>8.445630e+04</td>
      <td>...</td>
      <td>18.612972</td>
      <td>27.569003</td>
      <td>27.569003</td>
      <td>37.382189</td>
      <td>16.904226</td>
      <td>30.001182</td>
      <td>18.784377</td>
      <td>17.028241</td>
      <td>24.229137</td>
      <td>24.229137</td>
    </tr>
    <tr>
      <th>13</th>
      <td>5.512381e+07</td>
      <td>Asia</td>
      <td>Myanmar</td>
      <td>MMR</td>
      <td>311100.0</td>
      <td>POLYGON ((100.11599 20.41785, 99.54331 20.1866...</td>
      <td>Myanmar</td>
      <td>1059409.6</td>
      <td>1.052288e+06</td>
      <td>1.087030e+06</td>
      <td>...</td>
      <td>14.853751</td>
      <td>14.697380</td>
      <td>14.697380</td>
      <td>-6.859731</td>
      <td>-22.666619</td>
      <td>-10.868129</td>
      <td>-22.665852</td>
      <td>-16.045425</td>
      <td>-15.863111</td>
      <td>-15.863111</td>
    </tr>
    <tr>
      <th>14</th>
      <td>3.138199e+07</td>
      <td>Asia</td>
      <td>Malaysia</td>
      <td>MYS</td>
      <td>863000.0</td>
      <td>MULTIPOLYGON (((100.08576 6.46449, 100.25960 6...</td>
      <td>Malaysia</td>
      <td>121942.6</td>
      <td>1.232328e+05</td>
      <td>1.226563e+05</td>
      <td>...</td>
      <td>14.753544</td>
      <td>13.043224</td>
      <td>13.043224</td>
      <td>13.287137</td>
      <td>9.922595</td>
      <td>9.398001</td>
      <td>14.840462</td>
      <td>13.739977</td>
      <td>12.244674</td>
      <td>12.244674</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2.938430e+07</td>
      <td>Asia</td>
      <td>Nepal</td>
      <td>NPL</td>
      <td>71520.0</td>
      <td>POLYGON ((88.12044 27.87654, 88.04313 27.44582...</td>
      <td>Nepal</td>
      <td>149262.2</td>
      <td>1.427237e+05</td>
      <td>1.625746e+05</td>
      <td>...</td>
      <td>29.190154</td>
      <td>50.437328</td>
      <td>50.437328</td>
      <td>32.502761</td>
      <td>53.286238</td>
      <td>50.291743</td>
      <td>40.212459</td>
      <td>25.472433</td>
      <td>40.279401</td>
      <td>40.279401</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2.049249e+08</td>
      <td>Asia</td>
      <td>Pakistan</td>
      <td>PAK</td>
      <td>988200.0</td>
      <td>POLYGON ((77.83745 35.49401, 76.87172 34.65354...</td>
      <td>Pakistan</td>
      <td>383529.3</td>
      <td>3.813618e+05</td>
      <td>4.060833e+05</td>
      <td>...</td>
      <td>42.334367</td>
      <td>31.154530</td>
      <td>31.154530</td>
      <td>-26.520489</td>
      <td>-55.912882</td>
      <td>-32.303912</td>
      <td>-15.207139</td>
      <td>-53.701452</td>
      <td>-36.903009</td>
      <td>-36.903009</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1.042561e+08</td>
      <td>Asia</td>
      <td>Philippines</td>
      <td>PHL</td>
      <td>801900.0</td>
      <td>MULTIPOLYGON (((120.83390 12.70450, 120.32344 ...</td>
      <td>Philippines (the)</td>
      <td>1557810.6</td>
      <td>1.524292e+06</td>
      <td>1.609862e+06</td>
      <td>...</td>
      <td>125.114417</td>
      <td>121.748165</td>
      <td>121.748165</td>
      <td>77.968948</td>
      <td>73.275770</td>
      <td>76.166725</td>
      <td>74.003201</td>
      <td>76.966391</td>
      <td>75.679166</td>
      <td>75.679166</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2.524814e+07</td>
      <td>Asia</td>
      <td>North Korea</td>
      <td>PRK</td>
      <td>40000.0</td>
      <td>MULTIPOLYGON (((130.78000 42.22001, 130.78000 ...</td>
      <td>Korea (the Democratic People's Republic of)</td>
      <td>82823.3</td>
      <td>8.344230e+04</td>
      <td>8.459620e+04</td>
      <td>...</td>
      <td>15.169422</td>
      <td>17.492669</td>
      <td>17.492669</td>
      <td>-38.030793</td>
      <td>-9.988016</td>
      <td>-28.310326</td>
      <td>-3.195586</td>
      <td>-16.414407</td>
      <td>-19.169278</td>
      <td>-19.169278</td>
    </tr>
    <tr>
      <th>19</th>
      <td>6.841414e+07</td>
      <td>Asia</td>
      <td>Thailand</td>
      <td>THA</td>
      <td>1161000.0</td>
      <td>POLYGON ((105.21878 14.27321, 104.28142 14.416...</td>
      <td>Thailand</td>
      <td>1554254.0</td>
      <td>1.703328e+06</td>
      <td>1.714466e+06</td>
      <td>...</td>
      <td>17.404685</td>
      <td>22.551331</td>
      <td>22.551331</td>
      <td>10.323662</td>
      <td>-4.559627</td>
      <td>32.066348</td>
      <td>46.173612</td>
      <td>16.011325</td>
      <td>20.266184</td>
      <td>20.266184</td>
    </tr>
    <tr>
      <th>20</th>
      <td>2.350843e+07</td>
      <td>Asia</td>
      <td>Taiwan</td>
      <td>TWN</td>
      <td>1127000.0</td>
      <td>POLYGON ((121.77782 24.39427, 121.17563 22.790...</td>
      <td>Taiwan (Province of China)</td>
      <td>45838.7</td>
      <td>4.983830e+04</td>
      <td>4.999120e+04</td>
      <td>...</td>
      <td>58.617135</td>
      <td>52.458032</td>
      <td>52.458032</td>
      <td>-71.622589</td>
      <td>-62.307893</td>
      <td>-74.143329</td>
      <td>-64.692890</td>
      <td>-82.919716</td>
      <td>-71.109302</td>
      <td>-71.109302</td>
    </tr>
    <tr>
      <th>21</th>
      <td>3.266258e+08</td>
      <td>North America</td>
      <td>United States of America</td>
      <td>USA</td>
      <td>18560000.0</td>
      <td>MULTIPOLYGON (((-122.84000 49.00000, -120.0000...</td>
      <td>United States of America (the)</td>
      <td>364728.0</td>
      <td>4.386620e+05</td>
      <td>3.362555e+05</td>
      <td>...</td>
      <td>69.713577</td>
      <td>78.850049</td>
      <td>78.850049</td>
      <td>55.821215</td>
      <td>63.101978</td>
      <td>49.895259</td>
      <td>59.792699</td>
      <td>51.694526</td>
      <td>56.553728</td>
      <td>56.553728</td>
    </tr>
    <tr>
      <th>22</th>
      <td>9.616016e+07</td>
      <td>Asia</td>
      <td>Vietnam</td>
      <td>VNM</td>
      <td>594900.0</td>
      <td>POLYGON ((104.33433 10.48654, 105.19991 10.889...</td>
      <td>Viet Nam</td>
      <td>1381744.4</td>
      <td>1.365174e+06</td>
      <td>1.360552e+06</td>
      <td>...</td>
      <td>3.761740</td>
      <td>0.902428</td>
      <td>0.902428</td>
      <td>2.585962</td>
      <td>-8.687738</td>
      <td>-3.372544</td>
      <td>1.405162</td>
      <td>3.692293</td>
      <td>-0.906518</td>
      <td>-0.906518</td>
    </tr>
    <tr>
      <th>23</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>mean</td>
      <td>948478.0</td>
      <td>9.522272e+05</td>
      <td>9.590840e+05</td>
      <td>...</td>
      <td>47.621862</td>
      <td>49.129925</td>
      <td>49.129925</td>
      <td>4.551116</td>
      <td>4.508756</td>
      <td>3.322003</td>
      <td>6.179080</td>
      <td>-1.533721</td>
      <td>3.599038</td>
      <td>3.599038</td>
    </tr>
    <tr>
      <th>24</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>None</td>
      <td>total</td>
      <td>21814994.0</td>
      <td>2.190123e+07</td>
      <td>2.205893e+07</td>
      <td>...</td>
      <td>1095.302835</td>
      <td>1129.988279</td>
      <td>1129.988279</td>
      <td>104.675658</td>
      <td>103.701389</td>
      <td>76.406059</td>
      <td>142.118831</td>
      <td>-35.275585</td>
      <td>82.777881</td>
      <td>82.777881</td>
    </tr>
  </tbody>
</table>
<p>25 rows × 78 columns</p>
</div></div></div>
</div>
<div class="section" id="merged-countries-to-file">
<h3>Merged Countries to File<a class="headerlink" href="#merged-countries-to-file" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gisout</span> <span class="o">=</span> <span class="s2">&quot;/Users/jnapolitano/Projects/wattime-takehome/data/MERGE_DATA_GEO.geojson&quot;</span>
<span class="n">merged_countries</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="n">gisout</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;GeoJSON&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/jnapolitano/venvs/finance/lib/python3.9/site-packages/geopandas/io/file.py:362: FutureWarning: pandas.Int64Index is deprecated and will be removed from pandas in a future version. Use pandas.Index with the appropriate dtype instead.
  pd.Int64Index,
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "venv"
        },
        kernelOptions: {
            kernelName: "venv",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'venv'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="data_exploration.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Emissions Estimation Data: A Comparison between FAOSTAT and University of Malysia Estimates</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Justin Napolitano<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>